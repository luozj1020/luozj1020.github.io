<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic|Roboto:300,300italic,400,400italic,700,700italic|Source Sans Pro:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">
<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
  <link rel="stylesheet" href="/lib/pace/pace-theme-minimal.min.css">
  <script src="/lib/pace/pace.min.js"></script>

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"luozj1020.github.io","root":"/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":true,"pangu":false,"comments":{"style":"tabs","active":"livers","storage":false,"lazyload":true,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta property="og:type" content="website">
<meta property="og:title" content="Î£2333! ã® åšå®¢">
<meta property="og:url" content="https://luozj1020.github.io/page/4/index.html">
<meta property="og:site_name" content="Î£2333! ã® åšå®¢">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="Î£2333!">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://luozj1020.github.io/page/4/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-CN'
  };
</script>

  <title>Î£2333! ã® åšå®¢</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --><link rel="alternate" href="/atom.xml" title="Î£2333! ã® åšå®¢" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage">

<!-- åŠ å…¥APlayeréŸ³ä¹æ’­æ”¾å™¨ -->
<link rel="stylesheet" href="/dist/APlayer.min.css">
<div id="aplayer"></div>
<script type="text/javascript" src="/dist/APlayer.min.js"></script>
<script type="text/javascript" src="/dist/music.js"></script>

  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="åˆ‡æ¢å¯¼èˆªæ ">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Î£2333! ã® åšå®¢</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>é¦–é¡µ</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>æ ‡ç­¾</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>å½’æ¡£</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>æœç´¢
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="æœç´¢..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://luozj1020.github.io/uncategorized/2021/05/12/week7-8/BUUCTF%20%E6%AF%8F%E6%97%A5%E6%89%93%E5%8D%A1%202021-5-11">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Î£2333!">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Î£2333! ã® åšå®¢">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/uncategorized/2021/05/12/week7-8/BUUCTF%20%E6%AF%8F%E6%97%A5%E6%89%93%E5%8D%A1%202021-5-11" class="post-title-link" itemprop="url">BUUCTF æ¯æ—¥æ‰“å¡ 2021-5-12</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2021-05-12 00:00:00" itemprop="dateCreated datePublished" datetime="2021-05-12T00:00:00+08:00">2021-05-12</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2021-08-12 16:46:08" itemprop="dateModified" datetime="2021-08-12T16:46:08+08:00">2021-08-12</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="buuctf-æ¯æ—¥æ‰“å¡-2021-5-12">BUUCTF æ¯æ—¥æ‰“å¡ 2021-5-12</h1>
<h2 id="å¼•è¨€">å¼•è¨€</h2>
<p>æ±‚ wp çš„æ—¶å€™ï¼Œå¤§ä½¬ä»¬å‘Šè¯‰æˆ‘ 2021 çº¢å¸½æ¯çš„ crypto éƒ½æ˜¯åŸé¢˜ã€‚ã€‚ã€‚ ä¸€å…±æœ‰ä¸‰ä»½ wp å…¶ä¸­ä¸¤ä»½çš„æ€è·¯æ˜¯ä¸€æ ·ï¼ˆä¹Ÿå°±æ˜¯åŸé¢˜çš„è§£ç­”ï¼‰ï¼Œå¦å¤–ä¸€ä»½æ˜¯å’Œæˆ‘åŒçº§çš„ Pheonix dl å½“æ—¶çš„è§£ç­”ï¼ˆæ„Ÿè°¢ Pheonix dlï¼ï¼‰èŠ±äº†ä¸€å°æ—¶è§£å‡ºæ¥çš„</p>
<h2 id="çº¢å¸½æ¯primegame">[2021 çº¢å¸½æ¯]primegame</h2>
<p><a target="_blank" rel="noopener" href="https://www.secmem.org/blog/2020/09/20/poka-science-war-hacking/">åŸé¢˜</a>åŠ å¯†ä»£ç å¦‚ä¸‹ï¼š <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> decimal <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> math</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> struct</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">primes = [<span class="number">2</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>, <span class="number">100</span>):</span><br><span class="line">    f = <span class="literal">True</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> primes:</span><br><span class="line">        <span class="keyword">if</span> i * i &lt; j:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">if</span> i % j == <span class="number">0</span>:</span><br><span class="line">            f = <span class="literal">False</span></span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">if</span> f:</span><br><span class="line">        primes.append(i)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Random shuffle the primes</span></span><br><span class="line"><span class="comment"># Now you cannot know the order</span></span><br><span class="line">seed = struct.unpack(<span class="string">&#x27;&lt;i&#x27;</span>, flag[<span class="number">5</span>:<span class="number">9</span>])[<span class="number">0</span>]</span><br><span class="line">random.seed(seed)</span><br><span class="line">random.shuffle(primes)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Use ln function</span></span><br><span class="line"><span class="comment"># Now you cannot know the key itself</span></span><br><span class="line">getcontext().prec = <span class="number">100</span></span><br><span class="line">keys = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(flag)):</span><br><span class="line">    keys.append(Decimal(primes[i]).ln())</span><br><span class="line"></span><br><span class="line"><span class="comment"># Sum values</span></span><br><span class="line"><span class="comment"># Now you cannot know the flag</span></span><br><span class="line">sum_ = Decimal(<span class="number">0.0</span>)</span><br><span class="line"><span class="keyword">for</span> i, c <span class="keyword">in</span> <span class="built_in">enumerate</span>(flag):</span><br><span class="line">    sum_ += c * Decimal(keys[i])</span><br><span class="line"></span><br><span class="line">ct = math.floor(sum_ * <span class="number">2</span> ** <span class="number">256</span>)</span><br><span class="line"><span class="built_in">print</span>(ct)</span><br></pre></td></tr></table></figure> è¯¥ä»£ç çš„ç»“æ„å¦‚ä¸‹ï¼š 1ã€æŸ¥æ‰¾ä¸è¶…è¿‡100çš„ç´ æ•°ã€‚ï¼ˆå…±25ä¸ªï¼‰ 2ã€é€šè¿‡ä½¿ç”¨ flag çš„ç¬¬6åˆ°ç¬¬9å­—èŠ‚ä½œä¸ºéšæœºç§å­ï¼Œå¯ä»¥å¯¹åè¿›åˆ¶ç´ æ•°æ•°ç»„è¿›è¡Œæ”¹ç»„ã€‚ 3ã€æ¯ä¸ªæ”¹ç»„çš„ç´ æ•°éƒ½å–ä»¥ e ä¸ºåº•çš„å¯¹æ•°ï¼Œåè¿›åˆ¶ç²¾åº¦ä¸º100ã€‚ 4ã€å°†ä¸Šä¸€æ­¥å¾—åˆ°çš„ ln å€¼ä¹˜ä»¥æ ‡è®°çš„æ¯ä¸ªå­—èŠ‚æ‰€è·å¾—çš„å€¼ç›¸åŠ ï¼Œä¹˜ä»¥ 2 ** 256 ç„¶åå››èˆäº”å…¥ã€‚</p>
<p>å¯¹æ¯”çº¢å¸½æ¯çš„åŠ å¯†ä»£ç ï¼š <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> decimal <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> math</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> struct</span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> (<span class="built_in">len</span>(flag) == <span class="number">48</span>)</span><br><span class="line">msg1 = flag[:<span class="number">24</span>]</span><br><span class="line">msg2 = flag[<span class="number">24</span>:]</span><br><span class="line">primes = [<span class="number">2</span>]</span><br><span class="line"><span class="comment"># è·å– [2,90] çš„ç´ æ•°</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>, <span class="number">90</span>):</span><br><span class="line">    f = <span class="literal">True</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> primes:</span><br><span class="line">        <span class="keyword">if</span> i * i &lt; j: <span class="comment"># i^2 &gt;= j</span></span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">if</span> i % j == <span class="number">0</span>:</span><br><span class="line">            f = <span class="literal">False</span></span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">if</span> f:</span><br><span class="line">        primes.append(i)</span><br><span class="line"></span><br><span class="line">getcontext().prec = <span class="number">100</span> <span class="comment"># ä¿ç•™ 100 ä½å°æ•°</span></span><br><span class="line">keys = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(msg1)): <span class="comment"># len(primes) = 24</span></span><br><span class="line">    keys.append(Decimal(primes[i]).ln())</span><br><span class="line"></span><br><span class="line">sum_ = Decimal(<span class="number">0.0</span>)</span><br><span class="line"><span class="keyword">for</span> i, c <span class="keyword">in</span> <span class="built_in">enumerate</span>(msg1):</span><br><span class="line">    sum_ += c * Decimal(keys[i])</span><br><span class="line"></span><br><span class="line">ct = math.floor(sum_ * <span class="number">2</span> ** <span class="number">256</span>)</span><br><span class="line"><span class="built_in">print</span>(ct)</span><br><span class="line"><span class="comment"># 597952043660446249020184773232983974017780255881942379044454676980646417087515453</span></span><br><span class="line">sum_ = Decimal(<span class="number">0.0</span>)</span><br><span class="line"><span class="keyword">for</span> i, c <span class="keyword">in</span> <span class="built_in">enumerate</span>(msg2):</span><br><span class="line">    sum_ += c * Decimal(keys[i])</span><br><span class="line"></span><br><span class="line">ct = math.floor(sum_ * <span class="number">2</span> ** <span class="number">256</span>)</span><br><span class="line"><span class="built_in">print</span>(ct)</span><br><span class="line"><span class="comment"># 425985475047781336789963300910446852783032712598571885345660550546372063410589918</span></span><br></pre></td></tr></table></figure> å‘ç°åŸé¢˜ä»£ç ç»“æ„ä¸­çš„ç¬¬äºŒæ­¥ï¼ˆä¹Ÿå°±æ˜¯æ‰“ä¹±ç´ æ•°æ•°ç»„é¡ºåºï¼‰æ˜¯æ²¡æœ‰çš„ï¼ˆæˆ‘è¯´å“ªæ¥çš„ random å’Œ struct åº“ğŸ˜‚ï¼‰ è€Œä¸”å°† flag åˆ†æˆä¸¤æ®µåŠ å¯†ï¼Œå› æ­¤ç»™äº†ä¸¤ä¸ª ct</p>
<p>é¦–å…ˆï¼Œè¿™å¯ä»¥è½¬åŒ–æˆ<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_33458986/article/details/104366177?utm_medium=distribute.pc_relevant.none-task-blog-2~default~BlogCommendFromBaidu~default-6.control&amp;depth_1-utm_source=distribute.pc_relevant.none-task-blog-2~default~BlogCommendFromBaidu~default-6.control">èƒŒåŒ…åŠ å¯†é—®é¢˜</a> èƒŒåŒ…åŠ å¯†æ˜¯å¯¹å¯†æ–‡çš„äºŒè¿›åˆ¶å­—ç¬¦ä¸²è¿›è¡ŒåŠ å¯† è‡³äºä¸ºä»€ä¹ˆè¿™é“é¢˜æ˜¯èƒŒåŒ…åŠ å¯†ï¼Œå°±æˆ‘ä¸ªäººçš„ç†è§£çš„è¯ï¼Œå¤§å¤šæ•°åŠ å¯†é—®é¢˜éƒ½å¯ä»¥è½¬åŒ–æˆèƒŒåŒ…é—®é¢˜è§£å†³ï¼ˆä¾‹å¦‚ RSA ä¸­çš„ CopperSmith æ”»å‡»æ³•ï¼‰ï¼Œç»™æˆ‘çµæ„Ÿçš„æ˜¯ <code>2 ** 256</code> ä¹Ÿå°±æ˜¯ <span class="math inline">\(2^{2^{8}}\)</span>ï¼Œè”æƒ³åˆ°å­—ç¬¦ 8 ä½äºŒè¿›åˆ¶ï¼ˆè™½ç„¶æ²¡ä»€ä¹ˆæ ¹æ®å°±æ˜¯äº†ï¼‰ æœ€åä¹Ÿæ²¡æœ‰æ€è·¯å°±æ˜¯äº†ã€‚ã€‚ã€‚</p>
<p>wp çš„è§£æ³•ä¹Ÿéƒ½æ˜¯è½¬åŒ–ä¸ºå¯¹ä¸¤æ®µåˆ†åˆ«è¿›è¡ŒèƒŒåŒ…é—®é¢˜æ±‚è§£</p>
<h3 id="peonix-dl-è§£æ³•">Peonix dl è§£æ³•</h3>
<p>dl çš„æ‰‹ç¨¿ï¼š <img data-src="https://img-blog.csdnimg.cn/20210511161219566.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MjQ0NjA5NQ==,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" /> é¦–å…ˆï¼Œå°† flag å‰24ä½è½¬åŒ–ä¸º 24*8 ä½çš„äºŒè¿›åˆ¶ å› ä¸ºåŸæ¥çš„ keys æ˜¯ç›´æ¥å¯¹æ¯ä½ flag è¿›è¡Œæ“ä½œï¼Œè€Œç°åœ¨æ˜¯è¦å¯¹æ¯ä½äºŒè¿›åˆ¶è¿›è¡Œæ“ä½œï¼Œæ‰€ä»¥è¦é‡æ–°æ„é€  keys ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> decimal <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> math</span><br><span class="line"></span><br><span class="line">flag = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">48</span>*<span class="number">8</span>):</span><br><span class="line">    flag.append(<span class="number">0</span>)</span><br><span class="line"><span class="keyword">assert</span> (<span class="built_in">len</span>(flag) == <span class="number">48</span>*<span class="number">8</span>)</span><br><span class="line">msg1 = flag[:<span class="number">24</span>*<span class="number">8</span>]</span><br><span class="line">msg2 = flag[<span class="number">24</span>*<span class="number">8</span>:]</span><br><span class="line">primes = [<span class="number">2</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>, <span class="number">90</span>):</span><br><span class="line">    f = <span class="literal">True</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> primes:</span><br><span class="line">        <span class="keyword">if</span> i * i &lt; j:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">if</span> i % j == <span class="number">0</span>:</span><br><span class="line">            f = <span class="literal">False</span></span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">if</span> f:</span><br><span class="line">        primes.append(i)</span><br><span class="line"></span><br><span class="line">getcontext().prec = <span class="number">100</span></span><br><span class="line">keys = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(msg1)):</span><br><span class="line">    keys.append(math.floor(<span class="number">2</span> ** <span class="number">256</span> * (<span class="number">2</span> ** (i % <span class="number">8</span>)) * Decimal(primes[i//<span class="number">8</span>]).ln()))</span><br><span class="line"><span class="built_in">print</span>(keys)</span><br></pre></td></tr></table></figure>
<p>éœ€è¦æ³¨æ„çš„æ˜¯è¿™é‡Œçš„äºŒè¿›åˆ¶å­—ç¬¦ä¸²æ˜¯å€’åºçš„ï¼Œä¹‹åè§£å¯†éœ€è¦å€’å›æ¥ å¦‚æ‰‹ç¨¿ä¸­æ‰€å†™çš„ï¼Œç”±äºå¯¹ keys å‘ä¸‹å–æ•´äº†ï¼Œæ‰€ä»¥ç­”æ¡ˆä¼šåå°ï¼Œæ‰€ä»¥éœ€è¦è°ƒæ•´ cï¼ˆæ®è¯´è°ƒæ•´èŠ±äº†å¤§éƒ¨åˆ†æ—¶é—´ï¼Œè¿™ä¹Ÿæ˜¯è¿™ä¸ªæ–¹æ¡ˆçš„ä¸€ä¸ªç¼ºé™·ï¼‰ ç„¶åæ¥ä¸‹æ¥å°±æ˜¯æ„é€ çŸ©é˜µï¼Œç”¨ LLL ç®—æ³•è§£å‡ºæœ€çŸ­å‘é‡å¾—åˆ°ç»“æœäº† è¿™é‡Œæ³¨æ„æœ€åç»“æœæ˜¯ä¸€ä¸ªæœ€åä¸€ä½æ˜¯ 0ï¼Œå…¶ä»–éƒ½æ˜¯ -1 æˆ– 1 çš„å‘é‡ï¼Œæœ‰æŠŠ -1 æ›¿æ¢æˆ 0 å’Œ 1 æ›¿æ¢æˆ 0 å¹¶ä¸” -1 æ›¿æ¢æˆ 1 ä¸¤ç§æƒ…å†µï¼Œéœ€è¦åˆ†åˆ«å°è¯• <img data-src="https://img-blog.csdnimg.cn/2021051123223440.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MjQ0NjA5NQ==,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" /> æ€ä¹ˆæ„é€ çŸ©é˜µå‚ç…§<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_33458986/article/details/104366177?utm_medium=distribute.pc_relevant.none-task-blog-2~default~BlogCommendFromBaidu~default-6.control&amp;depth_1-utm_source=distribute.pc_relevant.none-task-blog-2~default~BlogCommendFromBaidu~default-6.control">èƒŒåŒ…åŠ å¯†é—®é¢˜</a>ï¼Œè‡³äº LLL ç®—æ³•ï¼Œæ›¾ç»åœ¨ç ”ç©¶ cryptohack çš„æ—¶å€™ dl å°è¯•å¤ç°è¿‡ï¼Œä½†æ˜¯éå¸¸æ…¢ï¼ˆå½“ç„¶æˆ‘ä¹Ÿè¯•è¿‡ï¼Œä½†æ˜¯å¤±è´¥äº†ï¼‰ï¼Œç”¨ sagemath å°è£…å¥½çš„é€Ÿåº¦ä¼šæ¯”è¾ƒå¿« æœ€åæŠŠç»“æœå€’åºä¹‹å long_to_bytes å°±è¡Œäº† ç»“æœä¸ºï¼š <img data-src="https://img-blog.csdnimg.cn/20210511232614320.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" /> æˆ‘ä¸ªäººè®¤ä¸ºéš¾ç‚¹åœ¨äºæ„é€  keys ä»¥åŠæƒ³åˆ°å»æ„é€  keys ï¼Œè¿˜æœ‰å°±æ˜¯å­˜åœ¨éœ€è¦è°ƒæ•´ c è¿™ä¸ªç¼ºé™· è‡³äºå…¶ä»–éƒ¨åˆ†ï¼Œæƒ³åˆ°èƒŒåŒ…é—®é¢˜å°±æ˜¯é¡ºç†æˆç« çš„äº†</p>
<h3 id="åŸé¢˜è§£æ³•">åŸé¢˜è§£æ³•</h3>
<p>åœ¨<a target="_blank" rel="noopener" href="https://www.secmem.org/blog/2020/09/20/poka-science-war-hacking/">åŸé¢˜</a>ä¸­ï¼Œå°† flag ç›´æ¥ä½œä¸ºå­—ç¬¦ä¸²è€ƒè™‘ï¼Œè€Œä¸æ˜¯è½¬åŒ–ä¸ºäºŒè¿›åˆ¶å†æ±‚è§£ ä»£ç å¦‚ä¸‹ï¼š <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> math</span><br><span class="line"><span class="keyword">from</span> decimal <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> struct</span><br><span class="line"></span><br><span class="line">getcontext().prec = <span class="built_in">int</span>(<span class="number">100</span>)</span><br><span class="line"></span><br><span class="line">primes = [<span class="number">2</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>, <span class="number">100</span>):</span><br><span class="line">    f = <span class="literal">True</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> primes:</span><br><span class="line">        <span class="keyword">if</span> i * i &lt; j:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">if</span> i % j == <span class="number">0</span>:</span><br><span class="line">            f = <span class="literal">False</span></span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">if</span> f:</span><br><span class="line">        primes.append(i)</span><br><span class="line"></span><br><span class="line">keys = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(primes)):</span><br><span class="line">    keys.append(Decimal(<span class="built_in">int</span>(primes[i])).ln())</span><br><span class="line"></span><br><span class="line">arr = []</span><br><span class="line"><span class="keyword">for</span> v <span class="keyword">in</span> keys:</span><br><span class="line">    arr.append(<span class="built_in">int</span>(v * <span class="built_in">int</span>(<span class="number">16</span>) ** <span class="built_in">int</span>(<span class="number">64</span>)))</span><br><span class="line"></span><br><span class="line">ct = <span class="number">737384863737803670841307970259513146291422299366557325168325233349136771464845311</span></span><br><span class="line"><span class="comment">#ct = 425985475047781336789963300910446852783032712598571885345660550546372063410589918</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encrypt</span>(<span class="params">res</span>):</span></span><br><span class="line">    h = Decimal(<span class="built_in">int</span>(<span class="number">0</span>))</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(keys)):</span><br><span class="line">        h += res[i] * keys[i]</span><br><span class="line"></span><br><span class="line">    ct = <span class="built_in">int</span>(h * <span class="built_in">int</span>(<span class="number">16</span>)**<span class="built_in">int</span>(<span class="number">64</span>))</span><br><span class="line">    <span class="keyword">return</span> ct</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">f</span>(<span class="params">N</span>):</span></span><br><span class="line">    ln = <span class="built_in">len</span>(arr)</span><br><span class="line">    A = Matrix(ZZ, ln + <span class="number">1</span>, ln + <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(ln):</span><br><span class="line">        A[i, i] = <span class="number">1</span></span><br><span class="line">        A[i, ln] = arr[i] // N</span><br><span class="line">        A[ln, i] = <span class="number">64</span></span><br><span class="line"></span><br><span class="line">    A[ln, ln] = ct // N</span><br><span class="line"></span><br><span class="line">    res = A.LLL()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(ln + <span class="number">1</span>):</span><br><span class="line">        flag = <span class="literal">True</span></span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(ln):</span><br><span class="line">            <span class="keyword">if</span> -<span class="number">64</span> &lt;= res[i][j] &lt; <span class="number">64</span>:</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            flag = <span class="literal">False</span></span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">if</span> flag:</span><br><span class="line">            vec = [<span class="built_in">int</span>(v + <span class="number">64</span>) <span class="keyword">for</span> v <span class="keyword">in</span> res[i][:-<span class="number">1</span>]]</span><br><span class="line">            ret = encrypt(vec)</span><br><span class="line">            <span class="keyword">if</span> ret == ct:</span><br><span class="line">                <span class="built_in">print</span>(N, <span class="built_in">bytes</span>(vec))</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;NO&quot;</span>, ret, <span class="built_in">bytes</span>(vec))</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>, <span class="number">10000</span>):</span><br><span class="line">    <span class="built_in">print</span>(i)</span><br><span class="line">    f(i)</span><br></pre></td></tr></table></figure> ç”±äº flag å®é™…ä¸Šæ˜¯å¯ä»¥è¾“å…¥çš„å€¼ï¼Œæ‰€ä»¥å°†è¿™ä¸ªé—®é¢˜è§†ä¸º0~127èƒŒåŒ…è€Œä¸æ˜¯0/1èƒŒåŒ…ï¼Œå› æ­¤å®ƒä»¬ä¸èƒ½è¶…è¿‡128ï¼Œå› æ­¤æˆ‘ä»¬å°†è¾¹ç•Œè®¾ç½®ä¸º0~127ã€‚ ç±»ä¼¼äºä¸Šæ–‡æ‰€è¿°çš„æ–¹æ³•æ„é€ çŸ©é˜µï¼Œå¯¹è§’çº¿ä½ç½®ç›¸åŒï¼Œè€Œå°†æœ€åä¸€è¡Œå‰é¢çš„æ•°æ›¿æ¢æˆ 64 (128/2)ï¼Œä¸åŒä¸Šæ–‡çš„ 1 (2/1) è€Œåœ¨å¯»æ‰¾æœ€çŸ­å‘é‡çš„æ—¶å€™å°†èŒƒå›´é™åˆ¶åœ¨ [-64, 64] ï¼Œä¸åŒäºä¸Šæ–‡çš„ -1/1 è€Œè‡³äºæ•´é™¤ N çš„æ“ä½œï¼Œå¯ä»¥ç†è§£ä¸ºæ˜¯ä¸€ç§è¯¯å·®å¤„ç†çš„æ–¹å¼ï¼Œç”±äºåŠ å¯†æ—¶ä¹˜ <span class="math inline">\(2^{256}\)</span> é€ æˆäº†å¾ˆå¤§è¯¯å·®ï¼Œæ‰€ä»¥å°†å…¶æ”¾åœ¨ N ç¯ä¸Šè€Œä¸æ˜¯æ•´æ•°ç¯ä¸Šè®¨è®ºï¼ˆæˆ‘ä¹Ÿä¸æ‡‚è¿™æ˜¯ä»€ä¹ˆé“ç†ï¼Œä½†æ˜¯æ„Ÿè§‰å¾ˆæœ‰é“ç†ï¼‰ è€Œ keys å°±å’ŒåŸæ¥ä¸€æ ·ï¼Œåªæ˜¯æ¢äº†ä¸ªè¡¨ç¤º</p>
<h2 id="ç»“è¯­">ç»“è¯­</h2>
<p>äº‹å®ä¸Šï¼Œç±»ä¼¼çš„é—®é¢˜ä¹Ÿå¯ä»¥ç”¨ç±»ä¼¼çš„æ–¹æ³•è§£ï¼Œå¦‚åŸé¢˜ wp ä¸­æåˆ°çš„ cryptohack ä¸­çš„ä¸€é¢˜ å¤ªæ™šäº†æ˜å¤©å†è¯´ åˆ†æ wp ç©¶ç«Ÿèƒ½å­¦åˆ°ä»€ä¹ˆå‘¢ï¼Ÿåªèƒ½è¯´é•¿ç‚¹è§è¯†å§ï¼Œæˆ‘è§çš„è¿˜æ˜¯å¤ªå°‘äº† å¤ªå¼±å°äº†ï¼Œå› ä¸º æˆ‘ä»¬æ²¡æœ‰åŠ›é‡~ å¸Œæœ›ç»§ç»­åšæŒ</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://luozj1020.github.io/uncategorized/2021/05/12/week7-8/BUUCTF%20%E6%AF%8F%E6%97%A5%E6%89%93%E5%8D%A1%202021-5-12">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Î£2333!">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Î£2333! ã® åšå®¢">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/uncategorized/2021/05/12/week7-8/BUUCTF%20%E6%AF%8F%E6%97%A5%E6%89%93%E5%8D%A1%202021-5-12" class="post-title-link" itemprop="url">BUUCTF æ¯æ—¥æ‰“å¡ 2021-5-12</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2021-05-12 00:00:00" itemprop="dateCreated datePublished" datetime="2021-05-12T00:00:00+08:00">2021-05-12</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2021-08-12 16:46:08" itemprop="dateModified" datetime="2021-08-12T16:46:08+08:00">2021-08-12</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="buuctf-æ¯æ—¥æ‰“å¡-2021-5-12">BUUCTF æ¯æ—¥æ‰“å¡ 2021-5-12</h2>
<h2 id="å¼•è¨€">å¼•è¨€</h2>
<p>æ˜¨å¤©çˆ†è‚å®Œçº¢å¸½æ¯ primegame çš„ wp è§£æï¼ŒåŸæœ¬æƒ³ä¸¾ä¸€åä¸‰ä¸€ä¸‹åšä¸€ä¸‹ cryptohack çš„ä¸€é“ç±»ä¼¼çš„é¢˜ï¼Œä½†æ˜¯å¤ªæ™šäº†ï¼Œä»Šå¤©è¡¥ä¸Š è‡³äºå¦ä¸€é“ï¼Œæƒ³ç•™åˆ°å‘¨æœ«è®²ï¼Œå‘¨å…­è¿˜æœ‰å›½èµ›è¦æ‰“</p>
<h2 id="cryptohackreal-eisenstein">[cryptohack]Real Eisenstein</h2>
<p><img data-src="https://img-blog.csdnimg.cn/20210512194217309.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MjQ0NjA5NQ==,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" /> yysy è¿™ä¸ªé¢˜ç›®æè¿°ç»™äº†è·Ÿæ²¡ç»™ä¸€æ · çœ‹åŠ å¯†ä»£ç ï¼š <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> math</span><br><span class="line"><span class="keyword">from</span> decimal <span class="keyword">import</span> *</span><br><span class="line">getcontext().prec = <span class="number">100</span></span><br><span class="line"></span><br><span class="line">FLAG = <span class="string">&quot;crypto&#123;???????????????&#125;&quot;</span></span><br><span class="line">PRIMES = [<span class="number">2</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">11</span>, <span class="number">13</span>, <span class="number">17</span>, <span class="number">19</span>, <span class="number">23</span>, <span class="number">29</span>, <span class="number">31</span>, <span class="number">37</span>, <span class="number">41</span>, <span class="number">43</span>, <span class="number">47</span>, <span class="number">53</span>, <span class="number">59</span>, <span class="number">61</span>, <span class="number">67</span>, <span class="number">71</span>, <span class="number">73</span>, <span class="number">79</span>, <span class="number">83</span>, <span class="number">89</span>, <span class="number">97</span>, <span class="number">101</span>, <span class="number">103</span>]</span><br><span class="line"></span><br><span class="line">h = Decimal(<span class="number">0.0</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i, c <span class="keyword">in</span> <span class="built_in">enumerate</span>(FLAG):</span><br><span class="line">    h += <span class="built_in">ord</span>(c) * Decimal(PRIMES[i]).sqrt()</span><br><span class="line"></span><br><span class="line">ct = math.floor(h*<span class="number">16</span>**<span class="number">64</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;ciphertext: <span class="subst">&#123;ct&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ciphertext: 1350995397927355657956786955603012410260017344805998076702828160316695004588429433</span></span><br></pre></td></tr></table></figure> è·Ÿçº¢å¸½æ¯çš„åŠ å¯†ä»£ç ä¸èƒ½è¯´æ¯«ä¸ç›¸å¹²ï¼Œåªèƒ½è¯´å®Œå…¨ä¸€æ · å”¯äºŒä¸ä¸€æ ·çš„ï¼Œå°±æ˜¯æŠŠ primes é™å®šåœ¨ [0, 105] ï¼ŒæŠŠ ln() æ¢æˆäº† sqrt() ç›´æ¥ä¸Š sage ä»£ç ï¼š <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> decimal <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> math</span><br><span class="line"></span><br><span class="line">getcontext().prec = <span class="built_in">int</span>(<span class="number">100</span>)</span><br><span class="line"></span><br><span class="line">primes = [<span class="number">2</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">11</span>, <span class="number">13</span>, <span class="number">17</span>, <span class="number">19</span>, <span class="number">23</span>, <span class="number">29</span>, <span class="number">31</span>, <span class="number">37</span>, <span class="number">41</span>, <span class="number">43</span>, <span class="number">47</span>, <span class="number">53</span>, <span class="number">59</span>, <span class="number">61</span>, <span class="number">67</span>, <span class="number">71</span>, <span class="number">73</span>, <span class="number">79</span>, <span class="number">83</span>, <span class="number">89</span>, <span class="number">97</span>, <span class="number">101</span>, <span class="number">103</span>]</span><br><span class="line"></span><br><span class="line">keys = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(primes)):</span><br><span class="line">    keys.append(Decimal(<span class="built_in">int</span>(primes[i])).sqrt())</span><br><span class="line"></span><br><span class="line">arr = []</span><br><span class="line"><span class="keyword">for</span> v <span class="keyword">in</span> keys:</span><br><span class="line">    arr.append(<span class="built_in">int</span>(v * <span class="built_in">int</span>(<span class="number">16</span>) ** <span class="built_in">int</span>(<span class="number">64</span>)))</span><br><span class="line"></span><br><span class="line">ct = <span class="number">1350995397927355657956786955603012410260017344805998076702828160316695004588429433</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encrypt</span>(<span class="params">res</span>):</span></span><br><span class="line">    h = Decimal(<span class="built_in">int</span>(<span class="number">0</span>))</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(keys)):</span><br><span class="line">        h += res[i] * keys[i]</span><br><span class="line">    ct = <span class="built_in">int</span>(h * <span class="built_in">int</span>(<span class="number">16</span>)**<span class="built_in">int</span>(<span class="number">64</span>))</span><br><span class="line">    <span class="keyword">return</span> ct</span><br><span class="line">    </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">f</span>(<span class="params">N</span>):</span></span><br><span class="line">    ln = <span class="built_in">len</span>(arr)</span><br><span class="line">    A = Matrix(ZZ, ln + <span class="number">1</span>, ln + <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(ln):</span><br><span class="line">        A[i, i] = <span class="number">1</span></span><br><span class="line">        A[i, ln] = arr[i] // N</span><br><span class="line">        A[ln, i] = <span class="number">64</span></span><br><span class="line"></span><br><span class="line">    A[ln, ln] = ct // N</span><br><span class="line"></span><br><span class="line">    res = A.LLL()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(ln + <span class="number">1</span>):</span><br><span class="line">        flag = <span class="literal">True</span></span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(ln):</span><br><span class="line">            <span class="keyword">if</span> -<span class="number">64</span> &lt;= res[i][j] &lt; <span class="number">64</span>:</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            flag = <span class="literal">False</span></span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">if</span> flag:</span><br><span class="line">            vec = [<span class="built_in">int</span>(v + <span class="number">64</span>) <span class="keyword">for</span> v <span class="keyword">in</span> res[i][:-<span class="number">1</span>]]</span><br><span class="line">            ret = encrypt(vec)</span><br><span class="line">            <span class="keyword">if</span> ret == ct:</span><br><span class="line">                <span class="built_in">print</span>(N, <span class="built_in">bytes</span>(vec))</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;NO&quot;</span>, ret, <span class="built_in">bytes</span>(vec))</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>, <span class="number">10000</span>):</span><br><span class="line">    <span class="built_in">print</span>(i)</span><br><span class="line">    f(i)</span><br></pre></td></tr></table></figure> è¿™é‡Œé‡‡ç”¨â€œåŸé¢˜â€è§£æ³•ï¼Œæ¯”è¾ƒæ–¹ä¾¿ ç»“æœä¸ºï¼š <img data-src="https://img-blog.csdnimg.cn/20210512194651892.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MjQ0NjA5NQ==,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" /> crypto{r34l_t0_23D_m4p}</p>
<h2 id="ç¼–ç ä¸è°ƒåˆ¶">ç¼–ç ä¸è°ƒåˆ¶</h2>
<p>ç›´æ¥æŠŠ wp çš„åœ°å€æ”¾åœ¨é¢˜ç›®é‡Œé¢æˆ‘æ˜¯æ²¡æƒ³åˆ°çš„ã€‚ã€‚ã€‚ çœ‹åˆ°è¿™ä¸ªé¢˜ç›®ï¼Œæƒ³åˆ°ä»¥å‰åšçš„ä¸€é“<a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_52446095/article/details/115384023?spm=1001.2014.3001.5501">ä¼ æ„Ÿå™¨</a> äº‹å®ä¸Šä¹Ÿæ˜¯è€ƒæŸ¥æ›¼å½»æ–¯ç‰¹ç¼–ç ï¼ˆå½“æ—¶è¿·æƒ‘çš„åœ°æ–¹å°±æ˜¯ï¼Œå¦‚æœå‡ºç°â€œ00â€æˆ–â€œ11â€çš„æƒ…å†µæ€ä¹ˆæ²¡æœ‰è€ƒè™‘ï¼Œç°åœ¨æƒ³æƒ³ï¼ŒåŠ å¯†çš„æ—¶å€™ä¹Ÿä¸ä¼šå‡ºç°å•Šï¼‰ å°†é¢˜ç›®ç»™çš„åå…­è¿›åˆ¶å­—ç¬¦ä¸²è½¬åŒ–æˆäºŒè¿›åˆ¶ï¼Œâ€œ10â€ï¼ˆé«˜ç”µå¹³è½¬ä½ç”µå¹³ï¼‰æ›¿æ¢æˆ â€œ1â€ï¼Œâ€œ01â€ï¼ˆä½ç”µå¹³è½¬é«˜ç”µå¹³ï¼‰æ›¿æ¢æˆ â€œ0â€ï¼Œåœ¨è½¬åŒ–æˆå­—ç¬¦ä¸²å°±è¡Œäº† ä»£ç å¦‚ä¸‹ï¼š <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">msg = <span class="number">0x2559659965656a9a65656996696965a6695669a9695a699569666a5a6a6569666a59695a69aa696569666aa6</span></span><br><span class="line">s = <span class="built_in">bin</span>(msg)[<span class="number">2</span>:]</span><br><span class="line">r = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(s)//<span class="number">2</span>):</span><br><span class="line">    <span class="keyword">if</span> s[i*<span class="number">2</span>:i*<span class="number">2</span>+<span class="number">2</span>] == <span class="string">&#x27;10&#x27;</span>:</span><br><span class="line">        r += <span class="string">&#x27;1&#x27;</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        r += <span class="string">&#x27;0&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(r, <span class="number">2</span>)))</span><br></pre></td></tr></table></figure> ç»“æœä¸ºï¼šBJD{DifManchestercode}</p>
<h2 id="crypto-classic1">crypto-classic1</h2>
<p>é™„ä»¶é‡Œé¢è¿˜æœ‰ä¸€ä¸ªåŠ å¯†äº†çš„é™„ä»¶ï¼Œç»™äº†ä¸€ä¸ªé™„ä»¶å¯†ç çš„ hintï¼š å“‡ï¼Œè¿™é‡Œæœ‰å‹ç¼©åŒ…çš„å¯†ç å“¦ï¼Œäºæ˜¯æˆ‘ä½ä¸‹äº†å¤´ï¼Œçœ‹å‘äº†æˆ‘çš„åŒæ‰‹ï¼Œè¯•å›¾ä»ä¸­æ‰¾åˆ°æŸäº›è§„å¾‹ xdfv ujko98 edft54 xdfv pok,.; wsdr43 è¿™æ˜¯ä»€ä¹ˆç©æ„? ä½å¤´çœ‹åŒæ‰‹ï¼Œé”®ç›˜åŠ å¯†ï¼Ÿ åŸæ¥æ˜¯é”®ç›˜ä¸Šå¯¹åº”å­—ç¬¦åŒ…è£¹èµ·æ¥çš„å­—ç¬¦ å¯†ç ä¸ºï¼šcircle åŠ å¯†é™„ä»¶æ–‡ä»¶åæ˜¯ vigenereï¼Œæ‰€ä»¥æ˜¯ç»´å‰å°¼äºšå¯†ç ï¼Œç»™äº†ä¸€ä¸ªå¯†æ–‡ï¼šSRLU{LZPL_S_UASHKXUPD_NXYTFTJT} è¿˜éœ€è¦å¯†é’¥ ç”±äºé¢˜ç›®æ¥æºäº[ACTFæ–°ç”Ÿèµ›2020]ï¼Œæ¨æµ‹ flag æ ¼å¼ä¸º actf{} å¯¹åº”ç»´å‰å°¼äºšè¡¨æ ¼ï¼š <img data-src="https://img-blog.csdnimg.cn/20210512200329755.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MjQ0NjA5NQ==,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" /> å‰å››ä½å¯¹åº”çš„å¯†é’¥æ˜¯ï¼šspsp çŒœæƒ³å¯†é’¥æ˜¯ sp è§£å¯†ç»“æœä¸ºï¼š <img data-src="https://img-blog.csdnimg.cn/20210512200429363.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MjQ0NjA5NQ==,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" /> ä½†æ˜¯æäº¤ flag æ€ä¹ˆéƒ½ä¸å¯¹ åªèƒ½æ‰¾ <a target="_blank" rel="noopener" href="https://blog.csdn.net/u011718707/article/details/108207138">wp</a> <img data-src="https://img-blog.csdnimg.cn/20210512200525952.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MjQ0NjA5NQ==,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" /> å•Šè¿™ã€‚ã€‚ã€‚ æ­£ç¡®çš„ flag ä¸ºï¼šACTF{WHAT_A_CLASSICAL_VIGENERE}</p>
<h2 id="ç»“è¯­">ç»“è¯­</h2>
<p>å¸Œæœ›ç»§ç»­åšæŒ</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://luozj1020.github.io/uncategorized/2021/05/10/week7-8/BUUCTF%20%E6%AF%8F%E6%97%A5%E6%89%93%E5%8D%A1%202021-5-10">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Î£2333!">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Î£2333! ã® åšå®¢">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/uncategorized/2021/05/10/week7-8/BUUCTF%20%E6%AF%8F%E6%97%A5%E6%89%93%E5%8D%A1%202021-5-10" class="post-title-link" itemprop="url">BUUCTF æ¯æ—¥æ‰“å¡ 2021-5-10</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2021-05-10 00:00:00" itemprop="dateCreated datePublished" datetime="2021-05-10T00:00:00+08:00">2021-05-10</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2021-08-12 16:46:08" itemprop="dateModified" datetime="2021-08-12T16:46:08+08:00">2021-08-12</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="buuctf-æ¯æ—¥æ‰“å¡-2021-5-10">BUUCTF æ¯æ—¥æ‰“å¡ 2021-5-10</h1>
<h2 id="å¼•è¨€">å¼•è¨€</h2>
<p>æ—¶é—´å¤ªæ™šäº†ï¼ŒåŸæœ¬æƒ³è®²ä¸€è®²çº¢å¸½æ¯çš„ crypto çš„ï¼ˆå¹²å•¥å•¥ä¸è¡Œï¼Œæ‰¾ wp ç¬¬ä¸€åï¼‰</p>
<h2 id="polybius">Polybius</h2>
<p>æ³¢åˆ©æ¯”å¥¥æ–¯æ–¹é˜µå¯†ç ï¼ˆ<a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Polybius_square">Polybius square</a>ï¼‰ å‚è€ƒäº† <a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_44110537/article/details/107302665">wp</a> é™„ä»¶å†…å®¹ï¼š å¯†æ–‡ï¼šouauuuoooeeaaiaeauieuooeeiea hintï¼šVGhlIGxlbmd0aCBvZiB0aGlzIHBsYWludGV4dDogMTQ= flag:è§£å‡ºæ˜æ–‡åï¼Œè¯·åŠ ä¸ŠBJD{}</p>
<p>hint è§£å¯†å†…å®¹ï¼š <img data-src="https://img-blog.csdnimg.cn/20210511000159954.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" /> è€Œå¯†æ–‡å†…å®¹æœ‰ 28 ä½ è”æƒ³åˆ°æ³¢åˆ©æ¯”å¥¥æ–¯æ–¹é˜µå¯†ç åŠ å¯†ç»“æœä¸ºæ³¢åˆ©æ¯”å¥¥æ–¯æ–¹é˜µä¸­çš„åæ ‡ å¦‚ wp ä¸­æ‰€è¯´ï¼Œå¯†æ–‡ä¸­çš„å­—æ¯å¯¹åº”äº â€œaeiouâ€ å­—ç¬¦ä¸²ä¸­å­—æ¯åœ¨æ³¢åˆ©æ¯”å¥¥æ–¯æ–¹é˜µä¸­çš„ä½ç½® ç”±äºä¸çŸ¥é“ "a", "e", "i", "o", "u" çš„æ’åˆ—é¡ºåºï¼Œå°±æœ‰ 5<em>4</em>3<em>2</em>1 ç§æƒ…å†µ è€Œæ³¢åˆ©æ¯”å¥¥æ–¯æ–¹é˜µä¸­ï¼ˆ2ï¼Œ4ï¼‰ä¸ºå¯ä»¥æ˜¯ i æˆ– j æ‰€ä»¥ä¸€å…±æœ‰ 5<em>4</em>3<em>2</em>1*2 ç§æƒ…å†µ ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line"></span><br><span class="line">s = <span class="string">&quot;aeoiu&quot;</span></span><br><span class="line">sumresult = []</span><br><span class="line">numsumresult = []</span><br><span class="line">cipher = <span class="string">&quot;ouauuuoooeeaaiaeauieuooeeiea&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> itertools.permutations(s, <span class="number">5</span>): <span class="comment"># æ‰¾å‡ºå…¨æ’åˆ—</span></span><br><span class="line">    sumresult.append(<span class="string">&quot;&quot;</span>.join(i))</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> sumresult:</span><br><span class="line">    temp = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> cipher:</span><br><span class="line">        temp += <span class="built_in">str</span>(i.index(j)+<span class="number">1</span>)</span><br><span class="line">    numsumresult.append(temp)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;è€ƒè™‘ï¼ˆ2ï¼Œ4ï¼‰ä½æ˜¯ i çš„æƒ…å†µ&#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> numsumresult:</span><br><span class="line">    ans_ = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(i), <span class="number">2</span>):</span><br><span class="line">        xx = (<span class="built_in">int</span>(i[j])-<span class="number">1</span>)*<span class="number">5</span> + <span class="built_in">int</span>(i[j+<span class="number">1</span>]) + <span class="number">96</span></span><br><span class="line">        <span class="keyword">if</span> xx &gt; <span class="built_in">ord</span>(<span class="string">&#x27;i&#x27;</span>):</span><br><span class="line">            xx += <span class="number">1</span></span><br><span class="line">        ans_ += <span class="built_in">chr</span>(xx)</span><br><span class="line">    <span class="built_in">print</span>(ans_)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;è€ƒè™‘ï¼ˆ2ï¼Œ4ï¼‰ä½æ˜¯ j çš„æƒ…å†µ&#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> numsumresult:</span><br><span class="line">    ans_ = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(i), <span class="number">2</span>):</span><br><span class="line">        xx = (<span class="built_in">int</span>(i[j])-<span class="number">1</span>)*<span class="number">5</span> + <span class="built_in">int</span>(i[j+<span class="number">1</span>]) + <span class="number">96</span></span><br><span class="line">        <span class="keyword">if</span> xx &gt; <span class="built_in">ord</span>(<span class="string">&#x27;h&#x27;</span>):</span><br><span class="line">            xx += <span class="number">1</span></span><br><span class="line">        ans_ += <span class="built_in">chr</span>(xx)</span><br><span class="line">    <span class="built_in">print</span>(ans_)</span><br></pre></td></tr></table></figure>
<p>(wp ä¸­æŒ‡è€ƒè™‘äº†è€ƒè™‘ï¼ˆ2ï¼Œ4ï¼‰ä½æ˜¯ i çš„æƒ…å†µï¼Œå¤§æ¦‚æ˜¯å·²ç»æ‰¾åˆ° flag äº†) ç»“æœä¸ºï¼š <img data-src="https://img-blog.csdnimg.cn/20210511000910208.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" /></p>
<h2 id="æƒ…ä¹¦">æƒ…ä¹¦</h2>
<p>é™„ä»¶å†…å®¹ï¼š Premise: Enumerate the alphabet by 0ã€1ã€2ã€..... ã€25 Using the RSA system Encryption:0156 0821 1616 0041 0140 2130 1616 0793 Public Key:2537 and 13 Private Key:2537 and 937</p>
<p>flag: wctf2020{Decryption}</p>
<p>å”¯ä¸€ è¿·æƒ‘äººçš„åœ°æ–¹å°±æ˜¯å¯†æ–‡æ¯ä¸²æ•°å­—å‰ä¸¤ä½éƒ½æ˜¯ 0 åˆ° 25 ä¹‹é—´ï¼Œå®¹æ˜“æé”™ å…¶å®ç»™äº†å¯†æ–‡ã€å¯†é’¥ç›´æ¥å¯¹æ¯ä¸²æ•°å­—è§£å¯†å°±è¡Œ ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">c = <span class="string">&#x27;0156 0821 1616 0041 0140 2130 1616 0793&#x27;</span>.split()</span><br><span class="line">m = <span class="string">&#x27;&#x27;</span></span><br><span class="line">n = <span class="number">2537</span></span><br><span class="line">d = <span class="number">937</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> c:</span><br><span class="line">    m += <span class="built_in">chr</span>(<span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>) + <span class="built_in">pow</span>(<span class="built_in">int</span>(i), d, n))</span><br><span class="line"><span class="built_in">print</span>(m)</span><br></pre></td></tr></table></figure>
<p>ç»“æœä¸ºï¼šiloveyou</p>
<h2 id="ç»“è¯­">ç»“è¯­</h2>
<p>æ˜å¤©å†å°† çº¢å¸½æ¯çš„ crypto å§ å¸Œæœ›ç»§ç»­åšæŒ</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://luozj1020.github.io/uncategorized/2021/05/09/week5-6/BUUCTF%20%E6%AF%8F%E6%97%A5%E6%89%93%E5%8D%A1%202021-5-9">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Î£2333!">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Î£2333! ã® åšå®¢">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/uncategorized/2021/05/09/week5-6/BUUCTF%20%E6%AF%8F%E6%97%A5%E6%89%93%E5%8D%A1%202021-5-9" class="post-title-link" itemprop="url">BUUCTF æ¯æ—¥æ‰“å¡ 2021-5-9</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2021-05-09 00:00:00" itemprop="dateCreated datePublished" datetime="2021-05-09T00:00:00+08:00">2021-05-09</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2021-08-12 16:46:08" itemprop="dateModified" datetime="2021-08-12T16:46:08+08:00">2021-08-12</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="buuctf-æ¯æ—¥æ‰“å¡-2021-5-9">BUUCTF æ¯æ—¥æ‰“å¡ 2021-5-9</h1>
<h2 id="å¼•è¨€">å¼•è¨€</h2>
<p>ä»Šå¤©çš„çº¢å¸½æ¯ï¼Œé›†ä½“æ‘¸é±¼æˆ‘æ˜¯æ²¡æƒ³åˆ°çš„ ç¬¬ä¸€é“ crypto æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªæ ¼å¯†ç é—®é¢˜ï¼ˆæ±‚åŠ©åˆ«äººï¼‰ ç¬¬äºŒé“æ˜¯æ¤­åœ†æ›²çº¿åŠ å¯†ï¼ˆç›´æ¥æ”¾å¼ƒï¼‰</p>
<h2 id="you_raise_me_up">you_raise_me_up</h2>
<p>åŠ å¯†ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line">n = <span class="number">2</span> ** <span class="number">512</span></span><br><span class="line">m = random.randint(<span class="number">2</span>, n-<span class="number">1</span>) | <span class="number">1</span></span><br><span class="line">c = <span class="built_in">pow</span>(m, bytes_to_long(flag), n)</span><br><span class="line"><span class="built_in">print</span> <span class="string">&#x27;m = &#x27;</span> + <span class="built_in">str</span>(m)</span><br><span class="line"><span class="built_in">print</span> <span class="string">&#x27;c = &#x27;</span> + <span class="built_in">str</span>(c)</span><br><span class="line"></span><br><span class="line"><span class="comment"># m = 391190709124527428959489662565274039318305952172936859403855079581402770986890308469084735451207885386318986881041563704825943945069343345307381099559075</span></span><br><span class="line"><span class="comment"># c = 6665851394203214245856789450723658632520816791621796775909766895233000234023642878786025644953797995373211308485605397024123180085924117610802485972584499</span></span><br></pre></td></tr></table></figure>
<p>æœ€åä¸€ä¸ªæœ‰ç‚¹åƒ RSA åŠ å¯†æœ€åä¸€æ­¥ æ²¡ä»€ä¹ˆæ€è·¯ï¼Œå°±å»æ‰¾ <a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_46230755/article/details/111290544">wp</a> äº† åŸæ¥æ˜¯ä¸€é“<a target="_blank" rel="noopener" href="https://ctf-wiki.org/crypto/asymmetric/discrete-log/discrete-log/#_1">ç¦»æ•£å¯¹æ•°é¢˜</a> <img data-src="https://img-blog.csdnimg.cn/20210509235207399.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" /> å¯¹äºæ²¡å­¦è¿‡ç¾¤è®ºçš„æˆ‘æ¥è¯´ï¼Œä¸€äº›æ¦‚å¿µéœ€è¦è¡¥å…… <strong>ç¾¤çš„é˜¶</strong>ï¼š å‚è€ƒ<a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/262254610">çŸ¥ä¹æ–‡ç« </a> é¦–å…ˆæ˜¯ç¾¤å…ƒç´ çš„é˜¶ï¼š <img data-src="https://img-blog.csdnimg.cn/20210509235448191.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" /> ä¸‹é¢æ˜¯ä¸¤ä¸ªä¾‹å­ï¼š <img data-src="https://img-blog.csdnimg.cn/20210509235550422.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" /> å¾ªç¯ç¾¤çš„é˜¶ï¼ˆåœ¨åŠ å¯†ä¸­ä¸€èˆ¬éƒ½è€ƒè™‘å¾ªç¯ç¾¤ï¼‰å°±æ˜¯æŒ‡ï¼š <img data-src="https://img-blog.csdnimg.cn/20210509235721894.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" /> è€Œä»€ä¹ˆæ˜¯å¾ªç¯ç¾¤ï¼Ÿä¸¾ä¸€ä¸ªä¾‹å­å°±æ˜¯æ•´æ•°æ¨¡ n ï¼Œå®¹æ˜“å‘ç°åœ¨æ¨¡ n çš„æƒ…å†µä¸‹ 1 å’Œ n+1 æ˜¯ç›¸ç­‰çš„ï¼Œå°±åƒå¾ªç¯ä¸€æ · <strong>å…‰æ»‘æ•°</strong>ï¼š å‚è€ƒ <a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E5%85%89%E6%BB%91%E6%95%B8">wiki</a> <img data-src="https://img-blog.csdnimg.cn/20210510000116914.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MjQ0NjA5NQ==,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" /> è®²çš„å¾ˆæ˜ç™½äº†</p>
<p>ç„¶è€Œä¸Šé¢ä¸¤ä¸ªæ¦‚å¿µè¿™é“é¢˜ä¸éœ€è¦çŸ¥é“ ctfwiki æä¾›äº†<a target="_blank" rel="noopener" href="https://ctf-wiki.org/crypto/asymmetric/discrete-log/discrete-log/#baby-step-giant-step">æš´åŠ›ç ´è§£çš„æ–¹æ³•</a>ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">m = <span class="number">391190709124527428959489662565274039318305952172936859403855079581402770986890308469084735451207885386318986881041563704825943945069343345307381099559075</span></span><br><span class="line">c = <span class="number">6665851394203214245856789450723658632520816791621796775909766895233000234023642878786025644953797995373211308485605397024123180085924117610802485972584499</span></span><br><span class="line">n = <span class="built_in">pow</span>(<span class="number">2</span>, <span class="number">512</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">bsgs</span>(<span class="params">g, y, p</span>):</span></span><br><span class="line">    m = <span class="built_in">int</span>(<span class="built_in">pow</span>(p - <span class="number">1</span>, <span class="number">1</span>/<span class="number">2</span>))</span><br><span class="line">    S = &#123;<span class="built_in">pow</span>(g, j, p): j <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(m)&#125;</span><br><span class="line">    gs = <span class="built_in">pow</span>(g, p - <span class="number">1</span> - m, p)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(m):</span><br><span class="line">        <span class="keyword">if</span> y <span class="keyword">in</span> S:</span><br><span class="line">            <span class="keyword">return</span> i * m + S[y]</span><br><span class="line">        y = y * gs % p</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">flag = bsgs(m, c, n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes((flag)))</span><br></pre></td></tr></table></figure>
<p>ç„¶è€Œè·‘äº†å‡ åˆ†é’Ÿæ²¡æœ‰ååº” å¦‚ wp æ‰€è¿°ï¼Œå»ºè®®ç”¨ sympy åº“æ±‚è§£ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> sympy</span><br><span class="line"></span><br><span class="line">m = <span class="number">391190709124527428959489662565274039318305952172936859403855079581402770986890308469084735451207885386318986881041563704825943945069343345307381099559075</span></span><br><span class="line">c = <span class="number">6665851394203214245856789450723658632520816791621796775909766895233000234023642878786025644953797995373211308485605397024123180085924117610802485972584499</span></span><br><span class="line">n = <span class="number">2</span> ** <span class="number">512</span></span><br><span class="line"></span><br><span class="line">flag = sympy.discrete_log(<span class="number">2</span>**<span class="number">512</span>,c,m)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(flag))</span><br></pre></td></tr></table></figure>
<p>ç»“æœä¸ºï¼šflag{5f95ca93-1594-762d-ed0b-a9139692cb4a}</p>
<h2 id="ç»“è¯­">ç»“è¯­</h2>
<p>å˜›ï¼Œè¿˜å·®å¾—è¿œå‘¢ å¸Œæœ›ç»§ç»­åšæŒ</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://luozj1020.github.io/uncategorized/2021/05/08/week5-6/BUUCTF%20%E6%AF%8F%E6%97%A5%E6%89%93%E5%8D%A1%202021-5-8">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Î£2333!">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Î£2333! ã® åšå®¢">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/uncategorized/2021/05/08/week5-6/BUUCTF%20%E6%AF%8F%E6%97%A5%E6%89%93%E5%8D%A1%202021-5-8" class="post-title-link" itemprop="url">BUUCTF æ¯æ—¥æ‰“å¡ 2021-5-8</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2021-05-08 00:00:00" itemprop="dateCreated datePublished" datetime="2021-05-08T00:00:00+08:00">2021-05-08</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2021-08-12 16:46:08" itemprop="dateModified" datetime="2021-08-12T16:46:08+08:00">2021-08-12</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="buuctf-æ¯æ—¥æ‰“å¡-2021-5-8">BUUCTF æ¯æ—¥æ‰“å¡ 2021-5-8</h2>
<h2 id="å¼•è¨€">å¼•è¨€</h2>
<p>æ— </p>
<h2 id="together">together</h2>
<p>é™„ä»¶æœ‰ä¸¤ä¸ª å…¬é’¥,pem å’Œ flag(base64ç¼–ç ) æ–‡ä»¶ è”æƒ³é¢˜ç›®ï¼Œå®¹æ˜“çŒœæƒ³æ˜¯ RSA å…±æ¨¡æ”»å‡» ç¼–å†™ä»£ç éªŒè¯ï¼š <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;pubkey1.pem&quot;</span>, <span class="string">&quot;r&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    key = RSA.import_key(f.read())</span><br><span class="line">    <span class="built_in">print</span>(key.n)</span><br><span class="line">    <span class="built_in">print</span>(key.e)</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;pubkey2.pem&quot;</span>, <span class="string">&quot;r&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    key = RSA.import_key(f.read())</span><br><span class="line">    <span class="built_in">print</span>(key.n)</span><br><span class="line">    <span class="built_in">print</span>(key.e)</span><br></pre></td></tr></table></figure> è¾“å‡ºç»“æœï¼š <img data-src="https://img-blog.csdnimg.cn/20210508125546497.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" /> çŒœæƒ³æˆç«‹ ç„¶åè¿›è¡Œå…±æ¨¡æ”»å‡» å®Œæ•´ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;pubkey1.pem&quot;</span>, <span class="string">&quot;r&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    key = RSA.import_key(f.read())</span><br><span class="line">    n1 = key.n</span><br><span class="line">    e1 = key.e</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;pubkey2.pem&quot;</span>, <span class="string">&quot;r&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    key = RSA.import_key(f.read())</span><br><span class="line">    n2 = key.n</span><br><span class="line">    e2 = key.e</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> n1 == n2</span><br><span class="line">n = n1</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;myflag1&#x27;</span>, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    c1 = <span class="built_in">int</span>(base64.b64decode(f.read()).<span class="built_in">hex</span>(), <span class="number">16</span>)</span><br><span class="line">    <span class="built_in">print</span>(c1)</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;myflag2&#x27;</span>, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    c2 = <span class="built_in">int</span>(base64.b64decode(f.read()).<span class="built_in">hex</span>(), <span class="number">16</span>)</span><br><span class="line">    <span class="built_in">print</span>(c2)</span><br><span class="line"></span><br><span class="line">g, u, v = gmpy2.gcdext(e1, e2)</span><br><span class="line"><span class="keyword">if</span> u &lt; <span class="number">0</span>:</span><br><span class="line">    u = -u</span><br><span class="line">    c1 = inverse(c1, n)</span><br><span class="line"><span class="keyword">if</span> v &lt; <span class="number">0</span>:</span><br><span class="line">    v = -v</span><br><span class="line">    c2 = inverse(c2, n)</span><br><span class="line"></span><br><span class="line">m = (<span class="built_in">pow</span>(c1, u, n) * <span class="built_in">pow</span>(c2, v, n)) % n</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure>
<p>ç»“æœä¸ºï¼šflag{23re_SDxF_y78hu_5rFgS}</p>
<h2 id="babyrsa">babyRSA</h2>
<p>åŠ å¯†ä»£ç å¦‚ä¸‹ï¼š <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sympy</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> gcd, invert</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime, isPrime, getRandomNBitInteger, bytes_to_long, long_to_bytes</span><br><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line">flag = <span class="string">b&quot;MRCTF&#123;xxxx&#125;&quot;</span></span><br><span class="line">base = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">gen_p</span>():</span></span><br><span class="line">    P = [<span class="number">0</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">17</span>)]</span><br><span class="line">    P[<span class="number">0</span>] = getPrime(<span class="number">128</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">17</span>):</span><br><span class="line">        P[i] = sympy.nextprime(P[i-<span class="number">1</span>])</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;P_p :&quot;</span>, P[<span class="number">9</span>])</span><br><span class="line">    n = <span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">17</span>):</span><br><span class="line">        n *= P[i]</span><br><span class="line">    p = getPrime(<span class="number">1024</span>)</span><br><span class="line">    factor = <span class="built_in">pow</span>(p, base, n)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;P_factor :&quot;</span>, factor)</span><br><span class="line">    <span class="keyword">return</span> sympy.nextprime(p)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">gen_q</span>():</span></span><br><span class="line">    sub_Q = getPrime(<span class="number">1024</span>)</span><br><span class="line">    Q_1 = getPrime(<span class="number">1024</span>)</span><br><span class="line">    Q_2 = getPrime(<span class="number">1024</span>)</span><br><span class="line">    Q = sub_Q ** Q_2 % Q_1</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Q_1: &quot;</span>, Q_1)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Q_2: &quot;</span>, Q_2)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;sub_Q: &quot;</span>, sub_Q)</span><br><span class="line">    <span class="keyword">return</span> sympy.nextprime(Q)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    _E = base</span><br><span class="line">    _P = gen_p()</span><br><span class="line">    _Q = gen_q()</span><br><span class="line">    <span class="keyword">assert</span> (gcd(_E, (_P - <span class="number">1</span>) * (_Q - <span class="number">1</span>)) == <span class="number">1</span>)</span><br><span class="line">    _M = bytes_to_long(flag)</span><br><span class="line">    _C = <span class="built_in">pow</span>(_M, _E, _P * _Q)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Ciphertext = &quot;</span>, _C)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">P_p : 206027926847308612719677572554991143421</span></span><br><span class="line"><span class="string">P_factor : 213671742765908980787116579976289600595864704574134469173111790965233629909513884704158446946409910475727584342641848597858942209151114627306286393390259700239698869487469080881267182803062488043469138252786381822646126962323295676431679988602406971858136496624861228526070581338082202663895710929460596143281673761666804565161435963957655012011051936180536581488499059517946308650135300428672486819645279969693519039407892941672784362868653243632727928279698588177694171797254644864554162848696210763681197279758130811723700154618280764123396312330032986093579531909363210692564988076206283296967165522152288770019720928264542910922693728918198338839</span></span><br><span class="line"><span class="string">Q_1:  103766439849465588084625049495793857634556517064563488433148224524638105971161051763127718438062862548184814747601299494052813662851459740127499557785398714481909461631996020048315790167967699932967974484481209879664173009585231469785141628982021847883945871201430155071257803163523612863113967495969578605521</span></span><br><span class="line"><span class="string">Q_2:  151010734276916939790591461278981486442548035032350797306496105136358723586953123484087860176438629843688462671681777513652947555325607414858514566053513243083627810686084890261120641161987614435114887565491866120507844566210561620503961205851409386041194326728437073995372322433035153519757017396063066469743</span></span><br><span class="line"><span class="string">sub_Q:  168992529793593315757895995101430241994953638330919314800130536809801824971112039572562389449584350643924391984800978193707795909956472992631004290479273525116959461856227262232600089176950810729475058260332177626961286009876630340945093629959302803189668904123890991069113826241497783666995751391361028949651</span></span><br><span class="line"><span class="string">Ciphertext =  1709187240516367141460862187749451047644094885791761673574674330840842792189795049968394122216854491757922647656430908587059997070488674220330847871811836724541907666983042376216411561826640060734307013458794925025684062804589439843027290282034999617915124231838524593607080377300985152179828199569474241678651559771763395596697140206072537688129790126472053987391538280007082203006348029125729650207661362371936196789562658458778312533505938858959644541233578654340925901963957980047639114170033936570060250438906130591377904182111622236567507022711176457301476543461600524993045300728432815672077399879668276471832</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure> å…¶å®ä»–åŸé™„ä»¶ç»™çš„ä»£ç é‡Œé¢å®šä¹‰çš„ <code>GCD()</code> å‡½æ•°æ ¹æœ¬æ²¡æœ‰ç”¨åˆ°ï¼Œæˆ‘æŠŠå®ƒåˆ äº† åˆ†æä»£ç ï¼Œp å’Œ q åˆ†åˆ«ç”± <code>gen_p()</code> å’Œ <code>gen_q()</code> ä¸¤ä¸ªè‡ªå®šä¹‰å‡½æ•°è·å– å…¶ä¸­ q å¾ˆå®¹æ˜“æ±‚ï¼Œè€Œä¸”æŠŠéœ€è¦ç”¨åˆ°çš„æ•°æ®éƒ½ç»™äº† éœ€è¦æ³¨æ„çš„å°±æ˜¯ ç”¨åŸä»£ç çš„ <code>sympy.nextprime(sub_Q ** Q_2 % Q_1)</code> æ±‚ q ä¼šéå¸¸æ…¢ï¼Œæˆ‘ä»¬ç”¨ <code>sympy.nextprime(pow(sub_Q, Q_2, Q_1))</code> çš„æ–¹å¼æ±‚è§£ ä»£ç å¦‚ä¸‹ï¼š <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sympy</span><br><span class="line"><span class="comment"># æ±‚ q</span></span><br><span class="line">Q_1 = <span class="number">103766439849465588084625049495793857634556517064563488433148224524638105971161051763127718438062862548184814747601299494052813662851459740127499557785398714481909461631996020048315790167967699932967974484481209879664173009585231469785141628982021847883945871201430155071257803163523612863113967495969578605521</span></span><br><span class="line">Q_2 = <span class="number">151010734276916939790591461278981486442548035032350797306496105136358723586953123484087860176438629843688462671681777513652947555325607414858514566053513243083627810686084890261120641161987614435114887565491866120507844566210561620503961205851409386041194326728437073995372322433035153519757017396063066469743</span></span><br><span class="line">sub_Q = <span class="number">168992529793593315757895995101430241994953638330919314800130536809801824971112039572562389449584350643924391984800978193707795909956472992631004290479273525116959461856227262232600089176950810729475058260332177626961286009876630340945093629959302803189668904123890991069113826241497783666995751391361028949651</span></span><br><span class="line">q = sympy.nextprime(<span class="built_in">pow</span>(sub_Q, Q_2, Q_1))</span><br></pre></td></tr></table></figure> ç„¶åæ±‚ p å‘ç° <code>gen_p()</code> å‡½æ•°å’Œ RSA åŠ å¯†ç®—æ³•å¾ˆç›¸ä¼¼ï¼Œåªä¸è¿‡ n æ˜¯ 17 ä¸ªç´ æ•°ç›¸ä¹˜ å‘Šè¯‰æˆ‘ä»¬ P[9] å®¹æ˜“æ±‚å¾—å…¶ä»– 16 ä¸ªç›¸é‚»çš„ç´ æ•° æœ€åç±»ä¼¼äº RSA è§£å¯†å³å¯ ä»£ç å¦‚ä¸‹ï¼š <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sympy</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="comment"># æ±‚ p</span></span><br><span class="line">P_p = <span class="number">206027926847308612719677572554991143421</span></span><br><span class="line">P_factor = <span class="number">213671742765908980787116579976289600595864704574134469173111790965233629909513884704158446946409910475727584342641848597858942209151114627306286393390259700239698869487469080881267182803062488043469138252786381822646126962323295676431679988602406971858136496624861228526070581338082202663895710929460596143281673761666804565161435963957655012011051936180536581488499059517946308650135300428672486819645279969693519039407892941672784362868653243632727928279698588177694171797254644864554162848696210763681197279758130811723700154618280764123396312330032986093579531909363210692564988076206283296967165522152288770019720928264542910922693728918198338839</span></span><br><span class="line">list_P = [P_p]</span><br><span class="line">P = P_p</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">9</span>):</span><br><span class="line">    P = sympy.prevprime(P)</span><br><span class="line">    list_P.append(P)</span><br><span class="line">P = P_p</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">7</span>):</span><br><span class="line">    P = sympy.nextprime(P)</span><br><span class="line">    list_P.append(P)</span><br><span class="line"></span><br><span class="line">phi_p = <span class="number">1</span></span><br><span class="line">n_p = <span class="number">1</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(list_P)):</span><br><span class="line">    n_p *= list_P[i]</span><br><span class="line">    phi_p *= (list_P[i]-<span class="number">1</span>)</span><br><span class="line">d_p = inverse(e, phi_p)</span><br><span class="line">p = sympy.nextprime(<span class="built_in">pow</span>(P_factor, d_p, n_p))</span><br></pre></td></tr></table></figure> æœ€åå°±æ˜¯æœ€åŸºç¡€çš„ RSA è§£å¯†ç®—æ³•äº† å®Œæ•´ä»£ç å¦‚ä¸‹ï¼š <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sympy</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c = <span class="number">1709187240516367141460862187749451047644094885791761673574674330840842792189795049968394122216854491757922647656430908587059997070488674220330847871811836724541907666983042376216411561826640060734307013458794925025684062804589439843027290282034999617915124231838524593607080377300985152179828199569474241678651559771763395596697140206072537688129790126472053987391538280007082203006348029125729650207661362371936196789562658458778312533505938858959644541233578654340925901963957980047639114170033936570060250438906130591377904182111622236567507022711176457301476543461600524993045300728432815672077399879668276471832</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ±‚ q</span></span><br><span class="line">Q_1 = <span class="number">103766439849465588084625049495793857634556517064563488433148224524638105971161051763127718438062862548184814747601299494052813662851459740127499557785398714481909461631996020048315790167967699932967974484481209879664173009585231469785141628982021847883945871201430155071257803163523612863113967495969578605521</span></span><br><span class="line">Q_2 = <span class="number">151010734276916939790591461278981486442548035032350797306496105136358723586953123484087860176438629843688462671681777513652947555325607414858514566053513243083627810686084890261120641161987614435114887565491866120507844566210561620503961205851409386041194326728437073995372322433035153519757017396063066469743</span></span><br><span class="line">sub_Q = <span class="number">168992529793593315757895995101430241994953638330919314800130536809801824971112039572562389449584350643924391984800978193707795909956472992631004290479273525116959461856227262232600089176950810729475058260332177626961286009876630340945093629959302803189668904123890991069113826241497783666995751391361028949651</span></span><br><span class="line">q = sympy.nextprime(<span class="built_in">pow</span>(sub_Q, Q_2, Q_1))</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ±‚ p</span></span><br><span class="line">P_p = <span class="number">206027926847308612719677572554991143421</span></span><br><span class="line">P_factor = <span class="number">213671742765908980787116579976289600595864704574134469173111790965233629909513884704158446946409910475727584342641848597858942209151114627306286393390259700239698869487469080881267182803062488043469138252786381822646126962323295676431679988602406971858136496624861228526070581338082202663895710929460596143281673761666804565161435963957655012011051936180536581488499059517946308650135300428672486819645279969693519039407892941672784362868653243632727928279698588177694171797254644864554162848696210763681197279758130811723700154618280764123396312330032986093579531909363210692564988076206283296967165522152288770019720928264542910922693728918198338839</span></span><br><span class="line">list_P = [P_p]</span><br><span class="line">P = P_p</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">9</span>):</span><br><span class="line">    P = sympy.prevprime(P)</span><br><span class="line">    list_P.append(P)</span><br><span class="line">P = P_p</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">7</span>):</span><br><span class="line">    P = sympy.nextprime(P)</span><br><span class="line">    list_P.append(P)</span><br><span class="line"></span><br><span class="line">phi_p = <span class="number">1</span></span><br><span class="line">n_p = <span class="number">1</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(list_P)):</span><br><span class="line">    n_p *= list_P[i]</span><br><span class="line">    phi_p *= (list_P[i]-<span class="number">1</span>)</span><br><span class="line">d_p = inverse(e, phi_p)</span><br><span class="line">p = sympy.nextprime(<span class="built_in">pow</span>(P_factor, d_p, n_p))</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ±‚ c</span></span><br><span class="line">n = p*q</span><br><span class="line">phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d = inverse(e, phi)</span><br><span class="line">m = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure> ç»“æœï¼šMRCTF{sti11_<span class="citation" data-cites="_b">@_b</span><span class="citation" data-cites="by_qu3st10n">@by_qu3st10n</span>}</p>
<h2 id="ç»“è¯­">ç»“è¯­</h2>
<p>å¸Œæœ›ç»§ç»­åšæŒ</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://luozj1020.github.io/uncategorized/2021/05/07/week5-6/BUUCTF%20%E6%AF%8F%E6%97%A5%E6%89%93%E5%8D%A1%202021-5-7">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Î£2333!">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Î£2333! ã® åšå®¢">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/uncategorized/2021/05/07/week5-6/BUUCTF%20%E6%AF%8F%E6%97%A5%E6%89%93%E5%8D%A1%202021-5-7" class="post-title-link" itemprop="url">BUUCTF æ¯æ—¥æ‰“å¡ 2021-5-7</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2021-05-07 00:00:00" itemprop="dateCreated datePublished" datetime="2021-05-07T00:00:00+08:00">2021-05-07</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2021-08-12 16:46:08" itemprop="dateModified" datetime="2021-08-12T16:46:08+08:00">2021-08-12</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="buuctf-æ¯æ—¥æ‰“å¡-2021-5-7">BUUCTF æ¯æ—¥æ‰“å¡ 2021-5-7</h2>
<h2 id="å¼•è¨€">å¼•è¨€</h2>
<p>æ— </p>
<h2 id="å¤§æ•°è®¡ç®—">å¤§æ•°è®¡ç®—</h2>
<p>é¢˜ç›®æè¿°ï¼š flagç­‰äº wctf2020{Part1-Part2-Part3-Part4} æ¯ä¸€Partéƒ½ä¸ºæ•°çš„åå…­è¿›åˆ¶å½¢å¼ï¼ˆä¸éœ€è¦0x)ï¼Œå¹¶ç”¨ '-' è¿æ¥ Part1 = <span class="math inline">\(2020*2019*2018* \cdots *3*2*1\)</span> çš„å‰8ä½ Part2 = <span class="math inline">\(520^{1314} + 2333^{666}\)</span> çš„å‰8ä½ Part3 = å®‡å®™ç»ˆæé—®é¢˜çš„ç­”æ¡ˆ <span class="math inline">\(x,y,z\)</span> ç»å¯¹å€¼å’Œçš„å‰8ä½ Part4 = è§å›¾ç‰‡é™„ä»¶ï¼Œè®¡ç®—ç»“æœä¹˜ä¸Š<span class="math inline">\(1314\)</span></p>
<h3 id="part1">Part1</h3>
<p>ç¼–å†™ä¸€ä¸ªç®€å•çš„ä»£ç ï¼š <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">result = <span class="number">1</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2020</span>):</span><br><span class="line">    result *= (i+<span class="number">1</span>)</span><br><span class="line"><span class="built_in">print</span>(result)</span><br></pre></td></tr></table></figure> ç»“æœä¸ºï¼š <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">386096951826724872377527755309254829575652833764136996704568320001962744375418996245016343070140495922821200614629613676056064037951380768693631095293969806083283419391122768593135371533669789505644746708636245286071667761717496505605794126236016354348784410240335472055757629538266448781423997420044753128592681490931155652500393981945786030349664533711594345568989302186320705026331591010701401806321162676014168267730443127229747356930582741007966787455099581158386524638372751639313267766129679555735375331455412649323831848690561911358863665291691253184884758093169216097558804246779418405854622335480512182276766264945125914275956103428084284556933827302002697216249895052496440541172520541257873419634034161103824199316296993063661010122247477806751684315159325496718242301326410047304634788457407629483612153384782033983257542806498117448100169850242485622135551834378243035590642352839055096183047501262709727667023809372071930180723811416036636750921242111077253225291490924545632327925057149716099795229733989622278323677405784299876565959582090676790727740307049077225508605566490968403536385735238912741726753153654163800192588170739101544001978507890178193666229850683801023093469605890012191345770905436000032556827322145416135640856057548854287333531160062595436210299154833029310707445362782649537335586073636441409352069691324058033881627521130303343921325446543099236423768017622330952822024309856222944411670467670029292434583401736238439303991700945727580238299750982559170548833139100553910689597287121942263594164151082680213395221663587816012606720015052645832622621471333102685422392447559330215438244237647008830170109515277728376740158127469507982306996887556451828368694363732003992198093879746125762368988032934128856143997941342867059780561839990632437177907064694382432079447096605996943877612866685823347086095028180222170710715928986388757360066746071573539728102642573049976996579847448174187164026466837941823296708220196587010386827277994485087677372620093957914089258169972214872563807439573846201771190457487767436383507920863265001158985530332683629614342467843804937221206800149726658420435494370022064907930073825842356140820286864504429150801511854514365890388184309207375633689423525046829286070427382305637485912596973375367419760345739950217980127302509287481854594278265427658981413690677647108075218848723615631183228998263867303745241836596694419145869217246024705077412378592333080136866437588005631900741990955327512376380828834010898865112109122200117679929527578871952101638590795253704401058529870302842722801768976320289167271902599225625767622305121280203492060037659871687735744553956446891872856397638184308752827275833141465241377237087280607247672227911921476510099466427100947464296939925307947903326972670620615266725024373992589830067802295068263706563543372266200657231075725406225813916087447037257516901879820294473007469699120258797394881069240769625444137446394025363698666039205630857709229029682411964627222481342313835400760000248298282014684789191216782161001313299389221096618273488723978734883910176473532912398103689047801184926163882078889516242948227926207222798398599415190198383379958023224921700008504785581886491831617089767423337158587605657695370924035915232465034278959481229277255278641922703818140279236081674495149412290836894544282115179683616118844191583046672479060000997496671880332878428953950612778358032083448023516233258828937364836898528863330898553728662430714476112310836556548819026772896916666672491022632933230082044594787660656479369609508622352899543941383995692550547567969679794689990261140429300073943357022253659335410345587776835600085239314982274092032142617241600285547606153599286848476863161163541783080974843391064827635422937416295803320652151693691769908939733927283127338535832997562295235291634892349205745118756949780889187123971284330764415768476973033998802916258114465575907763749305205635060986278491975514474464672254458806857234410272869494209351555904987662052843555593641077334735000243185871626166435489995567743531839402525319028777252590673740070657146817606781166399960411132861682002655514447098043836381875601009788125213646389121448684764478666800367960493084953255241805961090727464679546615218982157594620688546771982908471364789755878887707044374010944486692997646137003523014144478339200998768863760703237203498326237220307578035692438887844741169784356786186401985299971489879829923194004083856969480041497397289465262863214647978593940815429794201584815761969377077597754446250785589118819688309472535988847810731264852902520018791994847255177619133199103397784696304617128344478292442325121108591633318029061667864784808515527387560252024100796176430107903015131441779467272344895619105502295519265018507118428238756968370367729287885962903983789250413811180716741127223957387264111710541149510905192956624428207083391894030881029258437087456354854256388583861141432235437699695203894352189291895609764592583127247584093330090479305172063745326415499877435366649909958866611266850377258481988425964258871356114398124542854504460141256012894066714195604604296809443585918770552117029738264919661512180130075143844966812954224436082616963714987190523714733696955227936508156266340713059106114761487944040893851195897985233581632996731726844059926287692271399731200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</span></span><br></pre></td></tr></table></figure> Part1ï¼š38609695 è½¬åå…­è¿›åˆ¶ï¼š24D231F</p>
<h3 id="part2">Part2</h3>
<p>ç›´æ¥ç”¨ python ç®—ï¼š<img data-src="https://img-blog.csdnimg.cn/20210507232309432.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MjQ0NjA5NQ==,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" /> ç»“æœä¸ºï¼š <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">67358675073930576996073993722567461850164722807074564948878417317473402927052829127082792032180094796252395096433983198952274168335392450509538309593385666431514980590592716015855911289321506036686643999492477513757215924758776455044536037020140456863773999261918973328815695045710068615401644013371977309012103898412096306361548001024977583422217671458264501188363086490125698404411163875599250631472344791340890807258094473727320110195601853152755087240330894053335818131077110273175715028846928201286446627946414753140891422257217210657051018005119011231825729783206822743971574711110393874816976266354981853740848193017816398023462606903346766612687790408415070020255296249418676249807212441079026250983961692920652966680193496784706192692613628105543621116002202680144634223494461659625064734199269350540205779713480943543889927915919259683768965037082643370773459533965219810073840472443356812334913011267861631024583721439843313283632252393379630383299598523037929812133138807072044576906149490490113840653244256197362973674055842990181720796496141363505718393822270218527760700369994972831534842781472514105407807279417668179333578100464787815389196826955497201910672296944059409606029603730111157226386643599020499425611604798218989413785508164561159754542908177698601111851024642335136611527906723782867198103433350776510482418582828560882474001127337861205717439932975849518063393530401772837736924736914846285298676339811297353234924091794918188257309391813418599493372303068163108621417737278803530572213749972358034814384186787621021593911334049398408117962215128441151972529070470429717565266547734379348873150272523271822724131161260146953117253978239691913721988312421114234651848572209530437943447365774218261113652983590167268527243129712467973675150813885739222841289549709569689560918679552000804353102265587269536197104995365208113361238214793349376601709287320691962025569441318004962409752672175447871755400848907951316397028636550476284126600721896236978828578849024817047688627396567760215637844575781201340411713410901387415097150001810731644704906580463682092951091073376627966232966312329119203820184242415159480596553046863575499835934379905722318707119304564096837225570386337451111503621022869027771621941235105328508169429847297696160848087696110478698810948121137387936577551170478133221632051268190997414006106830275793171130669067945012054593847771690058584752626174521036167711725373472145872472987785584869677825221641781524433380680668092633822451335545271833203427482749996978964078435417941459565163307999239089382722108845684107513974453105597828187596947603390837292678451072673709372346741758978218449321284455510126397518967502185664874536990177693703924032798926123849737513057251304979953532246771553748100752530930394182885368167026727688409697271253702259642032797882327918994179815400383367337203215938064919399556687943521993823720750997305976057751840104981535895783291939176032118935838607493242555676289868798140683411268035331709077028634328818544056041101480762484035614265528718720132396302035616727694893643384384202696363883821952117653841426152212136741932330060968422184519178149199302895488289650118600183818496708016481413704242955462575482947926185049572277249034187278692428277207506362256097428904426717710977347411241809884859683037796946927621459794307572757322054131305574740424632144992602305052743261521941792148633841874961055208272462900770503933839068194426250247291864679430728943202539192872303333804358392481348403129810207376835075575297015491422237138339359562906817960418892175230875862569</span></span><br></pre></td></tr></table></figure> Part2ï¼š67358675 è½¬åå…­è¿›åˆ¶ï¼š403CFD3</p>
<h3 id="part3">Part3</h3>
<p>å®‡å®™ç»ˆæé—®é¢˜ï¼šæ±‚ <span class="math inline">\(x,y,z\)</span> æ»¡è¶³æ–¹ç¨‹ <span class="math inline">\(x^{3} + y^{3} + z^{3} = 42\)</span> ï¼ˆåˆ«çœ‹çŸ¥ä¹ï¼Œé‡Œé¢ç­”æ¡ˆéƒ½æ˜¯é”™çš„ï¼Œä¸è¿‡æä¾›äº† 42 å’Œ ä¸¢ç•ªå›¾æ–¹ç¨‹ä¸¤ä¸ªçº¿ç´¢ï¼‰ å‚è€ƒæ–‡ç« ï¼š<a target="_blank" rel="noopener" href="https://www.theregister.com/2019/09/07/three_cubes_problem/">https://www.theregister.com/2019/09/07/three_cubes_problem/</a> å¯çŸ¥ <span class="math display">\[
\begin{cases}
x = -80538738812075974\\
y =  80435758145817515\\
z =  12602123297335631\\
\end{cases}
\]</span> åˆ†åˆ«å–ç»å¯¹å€¼ç›¸åŠ ï¼š <img data-src="https://img-blog.csdnimg.cn/20210508000255327.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MjQ0NjA5NQ==,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" /></p>
<p>ç»“æœä¸ºï¼š173576620255229120 Part3ï¼š17357662 è½¬åå…­è¿›åˆ¶ï¼š108DB5E</p>
<h3 id="part4">Part4</h3>
<p>å…ˆè®¡ç®—ä¸‹é¢çš„å®šç§¯åˆ†ï¼š <img data-src="https://img-blog.csdnimg.cn/20210507233058802.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MjQ0NjA5NQ==,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" /> å½“ç„¶å¯ä»¥æ‰‹ç®—ï¼š <span class="math display">\[
\mathop{ \int }\nolimits_0^222x \text{d} x + 36 = x^{2} |^{22}_{0} + 36 = 520
\]</span> æˆ–è€…å¯ä»¥ç”¨ SageMathï¼š <img data-src="https://img-blog.csdnimg.cn/20210507234242652.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MjQ0NjA5NQ==,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" /> è®¡ç®—ç»“æœï¼š <img data-src="https://img-blog.csdnimg.cn/20210507234359224.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MjQ0NjA5NQ==,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" /> Part4ï¼š683280 è½¬åå…­è¿›åˆ¶ï¼šA6D10</p>
<p>æœ€ç»ˆå¾—åˆ° flagï¼šwctf2020{24d231f-403cfd3-108db5e-a6d10}</p>
<h2 id="ç»“è¯­">ç»“è¯­</h2>
<p>å¸Œæœ›ç»§ç»­åšæŒ</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://luozj1020.github.io/uncategorized/2021/05/06/week5-6/BUUCTF%20%E6%AF%8F%E6%97%A5%E6%89%93%E5%8D%A1%202021-5-6">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Î£2333!">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Î£2333! ã® åšå®¢">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/uncategorized/2021/05/06/week5-6/BUUCTF%20%E6%AF%8F%E6%97%A5%E6%89%93%E5%8D%A1%202021-5-6" class="post-title-link" itemprop="url">BUUCTF æ¯æ—¥æ‰“å¡ 2021-5-6</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2021-05-06 00:00:00" itemprop="dateCreated datePublished" datetime="2021-05-06T00:00:00+08:00">2021-05-06</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2021-08-12 16:46:08" itemprop="dateModified" datetime="2021-08-12T16:46:08+08:00">2021-08-12</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="buuctf-æ¯æ—¥æ‰“å¡-2021-5-6">BUUCTF æ¯æ—¥æ‰“å¡ 2021-5-6</h2>
<h2 id="å¼•è¨€">å¼•è¨€</h2>
<p>äº”ä¸€å‡æœŸå…¨é¸½äº†ã€‚ã€‚ã€‚ æœç„¶å½“é¸½å­ä¼šä¸Šç˜¾ã€‚ã€‚ã€‚ å‡æœŸå‰ä¸€å¤©æ™šä¸Šç•™äº†åŠå°æ—¶æè¿™é“ RSA &amp; what ï¼Œç»“æœæåˆ°å‡Œæ™¨æŠŠæˆ‘å¿ƒæ€æå´©äº† ç„¶åå°±é¸½äº†ã€‚ã€‚ã€‚ ä»Šå¤©ç»ˆäºæå‡ºæ¥äº†</p>
<h2 id="rsa-what">RSA &amp; what</h2>
<p>é¦–å…ˆï¼ŒåŠ å¯†ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> bytes_to_long, getPrime</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randint</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> powmod</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">2048</span>)</span><br><span class="line">q = getPrime(<span class="number">2048</span>)</span><br><span class="line">N = p*q</span><br><span class="line">Phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_enc_key</span>(<span class="params">N,Phi</span>):</span></span><br><span class="line">    e = getPrime(N)</span><br><span class="line">    <span class="keyword">if</span> Phi % e == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> get_enc_key(N, Phi)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> e</span><br><span class="line">e1 = get_enc_key(randint(<span class="number">10</span>, <span class="number">12</span>), Phi)</span><br><span class="line">e2 = get_enc_key(randint(<span class="number">10</span>, <span class="number">12</span>), Phi)</span><br><span class="line"></span><br><span class="line">fr = <span class="built_in">open</span>(<span class="string">r&quot;./base64&quot;</span>, <span class="string">&quot;rb&quot;</span>)<span class="comment">#flag is in this file</span></span><br><span class="line">f1 = <span class="built_in">open</span>(<span class="string">r&quot;./HUB1&quot;</span>, <span class="string">&quot;wb&quot;</span>)</span><br><span class="line">f2 = <span class="built_in">open</span>(<span class="string">r&quot;./HUB2&quot;</span>, <span class="string">&quot;wb&quot;</span>)</span><br><span class="line">base64 = fr.read(<span class="number">255</span>) <span class="comment"># è¯»å–255ä¸ªå­—èŠ‚</span></span><br><span class="line">f1.write(<span class="string">&quot;%d\n%d\n&quot;</span> % (N, e1))</span><br><span class="line">f2.write(<span class="string">&quot;%d\n%d\n&quot;</span> % (N, e2))</span><br><span class="line"><span class="keyword">while</span> <span class="built_in">len</span>(base64)&gt;<span class="number">0</span>:</span><br><span class="line">    pt = bytes_to_long(base64)</span><br><span class="line">    ct1 = powmod(pt, e1, N)</span><br><span class="line">    ct2 = powmod(pt, e2, N)</span><br><span class="line">    f1.write(<span class="string">&quot;\n%d&quot;</span> % ct1)</span><br><span class="line">    f2.write(<span class="string">&quot;\n%d&quot;</span> % ct2)</span><br><span class="line">    base64 = fr.read(<span class="number">255</span>)</span><br><span class="line">fr.close()</span><br><span class="line">f1.close()</span><br><span class="line">f2.close()</span><br></pre></td></tr></table></figure>
<p>æ˜¯<a target="_blank" rel="noopener" href="https://ctf-wiki.org/crypto/asymmetric/rsa/rsa_module_attack/">å…±æ¨¡æ”»å‡»</a> <img data-src="https://img-blog.csdnimg.cn/20210507001231135.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MjQ0NjA5NQ==,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" /> å°† base64 åŠ å¯†çš„æ–‡ä»¶æ¯æ®µè¯»å– 255 ä¸ªå­—èŠ‚ç”¨ä¸åŒçš„ e åŠ å¯†åˆ†åˆ«å­˜å‚¨åœ¨ HUB1, HUB2 ä¸¤ä¸ªæ–‡ä»¶ä¸­ ç„¶åå°±å†™ä»£ç ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> gcdext</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get</span>(<span class="params">file</span>):</span></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(file, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        content = f.readlines()</span><br><span class="line">    n = content[<span class="number">0</span>]</span><br><span class="line">    e = <span class="built_in">int</span>(content[<span class="number">1</span>])</span><br><span class="line">    list_c = content[<span class="number">3</span>:]</span><br><span class="line">    <span class="keyword">return</span> (n, e, list_c)</span><br><span class="line"></span><br><span class="line">n, e1, list_c1 = get(<span class="string">&#x27;HUB1&#x27;</span>)</span><br><span class="line">n, e2, list_c2 = get(<span class="string">&#x27;HUB2&#x27;</span>)</span><br><span class="line">n = <span class="built_in">int</span>(n)</span><br><span class="line">g, u, v = gcdext(e1, e2)</span><br><span class="line"></span><br><span class="line">list_c3 = []</span><br><span class="line">list_c4 = []</span><br><span class="line"><span class="keyword">if</span> u &lt; <span class="number">0</span>:</span><br><span class="line">    u = -u</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(list_c1)):</span><br><span class="line">        list_c3.append(inverse(<span class="built_in">int</span>(list_c1[i]), n))</span><br><span class="line">        list_c4.append(<span class="built_in">int</span>(list_c2[i]))</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    v = -v</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(list_c2)):`åœ¨è¿™é‡Œæ’å…¥ä»£ç ç‰‡`</span><br><span class="line">        list_c4.append(inverse(<span class="built_in">int</span>(list_c2[i]), n))</span><br><span class="line">        list_c3.append(<span class="built_in">int</span>(list_c1[i]))</span><br><span class="line">list_c = <span class="built_in">list</span>(<span class="built_in">zip</span>(list_c3, list_c4))</span><br><span class="line"></span><br><span class="line">mm = <span class="string">&#x27;&#x27;</span>.encode()</span><br><span class="line"><span class="keyword">for</span> c3, c4 <span class="keyword">in</span> list_c:</span><br><span class="line">    m = (<span class="built_in">pow</span>(c3, u, n) * <span class="built_in">pow</span>(c4, v, n)) % n</span><br><span class="line">    <span class="built_in">print</span>((long_to_bytes(m)))</span><br><span class="line">    mm += long_to_bytes(m)</span><br><span class="line"><span class="built_in">print</span>(mm)</span><br><span class="line"><span class="built_in">print</span>(base64.b64decode(mm))</span><br></pre></td></tr></table></figure>
<p>è¾“å‡ºä¸º</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">b&#x27;VEhJUz==\nRkxBR3==\nSVN=\nSElEREVOLo==\nQ0FO\nWU9V\nRklORM==\nSVT=\nT1VUP4==\nRE8=\nWU9V\nS05PV9==\nQkFTRTY0P5==\nWW91bmdD\nVEhJTku=\nWU9V\nQVJF\nTk9U\nVEhBVE==\nRkFNSUxJQVI=\nV0lUSO==\nQkFTRTY0Lh==\nQmFzZTY0\naXO=\nYW==\nZ3JvdXA=\nb2b=\nc2ltaWxhcn==\nYmluYXJ5LXRvLXRleHR=\nZW5jb2Rpbm&#x27;</span></span><br><span class="line"><span class="string">b&#x27;e=\nc2NoZW1lc0==\ndGhhdD==\ncmVwcmVzZW50\nYmluYXJ5\nZGF0YW==\naW5=\nYW6=\nQVNDSUl=\nc3RyaW5n\nZm9ybWF0\nYnk=\ndHJhbnNsYXRpbmd=\naXS=\naW50b1==\nYT==\ncmFkaXgtNjQ=\ncmVwcmVzZW50YXRpb24u\nVGhl\ndGVybc==\nQmFzZTY0\nb3JpZ2luYXRlc8==\nZnJvbd==\nYY==\nc3BlY2lmaWN=\nTUlNRT==\nY29udGVudI=&#x27;</span></span><br><span class="line"><span class="string">b&#x27;=\ndHJhbnNmZXI=\nZW5jb2Rpbmcu\nVGhl\ncGFydGljdWxhct==\nc2V0\nb2b=\nNjR=\nY2hhcmFjdGVyc5==\nY2hvc2Vu\ndG+=\ncmVwcmVzZW50\ndGhl\nNjQ=\ncGxhY2UtdmFsdWVz\nZm9y\ndGhl\nYmFzZd==\ndmFyaWVz\nYmV0d2Vlbt==\naW1wbGVtZW50YXRpb25zLp==\nVGhl\nZ2VuZXJhbI==\nc3RyYXRlZ3n=\naXO=\ndG9=\nY2hvb3Nl\nNjR&#x27;</span></span><br><span class="line"><span class="string">b&#x27;=\nY2hhcmFjdGVyc5==\ndGhhdA==\nYXJl\nYm90aN==\nbWVtYmVyc5==\nb2a=\nYS==\nc3Vic2V0\nY29tbW9u\ndG8=\nbW9zdM==\nZW5jb2RpbmdzLA==\nYW5k\nYWxzb8==\ncHJpbnRhYmxlLg==\nVGhpc9==\nY29tYmluYXRpb25=\nbGVhdmVz\ndGhl\nZGF0YW==\ndW5saWtlbHk=\ndG/=\nYmV=\nbW9kaWZpZWS=\naW5=\ndHJhbnNpdE==\ndGhyb3V&#x27;</span></span><br><span class="line"><span class="string">b&#x27;naN==\naW5mb3JtYXRpb26=\nc3lzdGVtcyw=\nc3VjaN==\nYXM=\nRS1tYWlsLD==\ndGhhdA==\nd2VyZQ==\ndHJhZGl0aW9uYWxseQ==\nbm90\nOC1iaXQ=\nY2xlYW4uWzFd\nRm9y\nZXhhbXBsZSw=\nTUlNRSdz\nQmFzZTY0\naW1wbGVtZW50YXRpb24=\ndXNlcw==\nQahDWiw=\nYahDeiw=\nYW5k\nMKhDOQ==\nZm9y\ndGhl\nZmlyc3Q=\nNjI=\ndmFs&#x27;</span></span><br><span class="line"><span class="string">b&#x27;dWVzLg==\nT3RoZXI=\ndmFyaWF0aW9ucw==\nc2hhcmU=\ndGhpcw==\ncHJvcGVydHk=\nYnV0\nZGlmZmVy\naW4=\ndGhl\nc3ltYm9scw==\nY2hvc2Vu\nZm9y\ndGhl\nbGFzdA==\ndHdv\ndmFsdWVzOw==\nYW4=\nZXhhbXBsZQ==\naXM=\nVVRGLTcu&#x27;</span></span><br><span class="line"><span class="string">b&#x27;VEhJUz==\nRkxBR3==\nSVN=\nSElEREVOLo==\nQ0FO\nWU9V\nRklORM==\nSVT=\nT1VUP4==\nRE8=\nWU9V\nS05PV9==\nQkFTRTY0P5==\nWW91bmdD\nVEhJTku=\nWU9V\nQVJF\nTk9U\nVEhBVE==\nRkFNSUxJQVI=\nV0lUSO==\nQkFTRTY0Lh==\nQmFzZTY0\naXO=\nYW==\nZ3JvdXA=\nb2b=\nc2ltaWxhcn==\nYmluYXJ5LXRvLXRleHR=\nZW5jb2Rpbme=\nc2NoZW1lc0==\ndGhhdD==\ncmVwcmVzZW50\nYmluYXJ5\nZGF0YW==\naW5=\nYW6=\nQVNDSUl=\nc3RyaW5n\nZm9ybWF0\nYnk=\ndHJhbnNsYXRpbmd=\naXS=\naW50b1==\nYT==\ncmFkaXgtNjQ=\ncmVwcmVzZW50YXRpb24u\nVGhl\ndGVybc==\nQmFzZTY0\nb3JpZ2luYXRlc8==\nZnJvbd==\nYY==\nc3BlY2lmaWN=\nTUlNRT==\nY29udGVudI==\ndHJhbnNmZXI=\nZW5jb2Rpbmcu\nVGhl\ncGFydGljdWxhct==\nc2V0\nb2b=\nNjR=\nY2hhcmFjdGVyc5==\nY2hvc2Vu\ndG+=\ncmVwcmVzZW50\ndGhl\nNjQ=\ncGxhY2UtdmFsdWVz\nZm9y\ndGhl\nYmFzZd==\ndmFyaWVz\nYmV0d2Vlbt==\naW1wbGVtZW50YXRpb25zLp==\nVGhl\nZ2VuZXJhbI==\nc3RyYXRlZ3n=\naXO=\ndG9=\nY2hvb3Nl\nNjR=\nY2hhcmFjdGVyc5==\ndGhhdA==\nYXJl\nYm90aN==\nbWVtYmVyc5==\nb2a=\nYS==\nc3Vic2V0\nY29tbW9u\ndG8=\nbW9zdM==\nZW5jb2RpbmdzLA==\nYW5k\nYWxzb8==\ncHJpbnRhYmxlLg==\nVGhpc9==\nY29tYmluYXRpb25=\nbGVhdmVz\ndGhl\nZGF0YW==\ndW5saWtlbHk=\ndG/=\nYmV=\nbW9kaWZpZWS=\naW5=\ndHJhbnNpdE==\ndGhyb3VnaN==\naW5mb3JtYXRpb26=\nc3lzdGVtcyw=\nc3VjaN==\nYXM=\nRS1tYWlsLD==\ndGhhdA==\nd2VyZQ==\ndHJhZGl0aW9uYWxseQ==\nbm90\nOC1iaXQ=\nY2xlYW4uWzFd\nRm9y\nZXhhbXBsZSw=\nTUlNRSdz\nQmFzZTY0\naW1wbGVtZW50YXRpb24=\ndXNlcw==\nQahDWiw=\nYahDeiw=\nYW5k\nMKhDOQ==\nZm9y\ndGhl\nZmlyc3Q=\nNjI=\ndmFsdWVzLg==\nT3RoZXI=\ndmFyaWF0aW9ucw==\nc2hhcmU=\ndGhpcw==\ncHJvcGVydHk=\nYnV0\nZGlmZmVy\naW4=\ndGhl\nc3ltYm9scw==\nY2hvc2Vu\nZm9y\ndGhl\nbGFzdA==\ndHdv\ndmFsdWVzOw==\nYW4=\nZXhhbXBsZQ==\naXM=\nVVRGLTcu&#x27;</span></span><br><span class="line"><span class="string">b&#x27;THIS&#x27;</span></span><br></pre></td></tr></table></figure>
<p>å—¯ï¼Ÿæ€ä¹ˆå°±ä¸€ä¸ª <code>b'THIS'</code> ï¼Ÿ æäº†åŠå¤© å¿ƒæ€å´©äº† æ‰¾äº†å¾ˆå¤šèµ„æ–™ï¼ˆåŒ…æ‹¬ä¸€äº› wpï¼‰éƒ½ä¸èƒ½è§£å†³ ç»ˆäºæ‰¾åˆ°äº†åˆé€‚çš„ <a target="_blank" rel="noopener" href="https://www.codeleading.com/article/48943375092/">wp</a>(æ³ªç›®) ä¸­é—´é‚£ä¸ª <code>\n</code> åŸæ¥æ˜¯æ¢è¡Œç¬¦ã€‚ã€‚ã€‚ åé¢åŠ äº†ä¸€æ®µï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">temp = <span class="string">b&#x27;&#x27;</span></span><br><span class="line">M = <span class="string">b&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> mm:</span><br><span class="line">    k = long_to_bytes(i)</span><br><span class="line">    <span class="keyword">if</span> k == <span class="string">b&#x27;\n&#x27;</span>:</span><br><span class="line">        M += base64.b64decode(temp)</span><br><span class="line">        temp = <span class="string">b&#x27;&#x27;</span></span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    temp += k</span><br><span class="line"><span class="built_in">print</span>(M)</span><br></pre></td></tr></table></figure>
<p>è¾“å‡ºç»“æœä¸ºï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">b&quot;THISFLAGISHIDDEN.CANYOUFINDITOUT?DOYOUKNOWBASE64?YoungCTHINKYOUARENOTTHATFAMILIARWITHBASE64.Base64isagroupofsimilarbinary-to-textencodingschemesthatrepresentbinarydatainanASCIIstringformatbytranslatingitintoaradix-64representation.ThetermBase64originatesfromaspecificMIMEcontenttransferencoding.Theparticularsetof64characterschosentorepresentthe64place-valuesforthebasevariesbetweenimplementations.Thegeneralstrategyistochoose64charactersthatarebothmembersofasubsetcommontomostencodings,andalsoprintable.Thiscombinationleavesthedataunlikelytobemodifiedintransitthroughinformationsystems,suchasE-mail,thatweretraditionallynot8-bitclean.[1]Forexample,MIME&#x27;sBase64implementationusesA\xa8CZ,a\xa8Cz,and0\xa8C9forthefirst62values.Othervariationssharethispropertybutdifferinthesymbolschosenforthelasttwovalues;anexampleisUTF-7.&quot;</span></span><br></pre></td></tr></table></figure>
<p>çœ‹äº†åŠå¤©çœ‹ä¸å‡ºåå ‚ ä¸å°±æ˜¯æŠŠ base64 åŠ å¯†è§£é‡Šäº†ä¸€éå—ï¼Ÿ <code>THIS FLAG IS HIDDEN</code> æ‰€ä»¥æ˜¯æ€ä¹ˆéšè—çš„å‘¢ï¼Ÿ å‚ç…§ wp ï¼Œæ˜¯ base64 éšå†™ å†åŠ ä¸€æ®µä»£ç ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">c = mm</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_base64_diff_value</span>(<span class="params">s1, s2</span>):</span></span><br><span class="line">    base64chars = <span class="string">b&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&#x27;</span></span><br><span class="line">    res = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(s2)):</span><br><span class="line">        <span class="keyword">if</span> s1[i] != s2[i]:</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">abs</span>(base64chars.index(s1[i]) - base64chars.index(s2[i]))</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">solve_stego</span>():</span></span><br><span class="line">    line=<span class="string">b&#x27;&#x27;</span></span><br><span class="line">    bin_str=<span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> c:</span><br><span class="line">        k=long_to_bytes(i)</span><br><span class="line">        <span class="keyword">if</span> k==<span class="string">b&#x27;\n&#x27;</span>:</span><br><span class="line">            steg_line = line</span><br><span class="line">            norm_line = base64.b64encode(base64.b64decode(line))</span><br><span class="line">            diff = get_base64_diff_value(steg_line, norm_line)</span><br><span class="line">            <span class="comment">#print(diff)</span></span><br><span class="line">            pads_num = steg_line.count(<span class="string">b&#x27;=&#x27;</span>)</span><br><span class="line">            <span class="keyword">if</span> diff:</span><br><span class="line">                bin_str += <span class="built_in">bin</span>(diff)[<span class="number">2</span>:].zfill(pads_num * <span class="number">2</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                bin_str += <span class="string">&#x27;0&#x27;</span> * pads_num * <span class="number">2</span></span><br><span class="line">            <span class="built_in">print</span>(goflag(bin_str))</span><br><span class="line">            line=<span class="string">b&#x27;&#x27;</span></span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        line+=k</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">goflag</span>(<span class="params">bin_str</span>):</span></span><br><span class="line">    res_str = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(bin_str), <span class="number">8</span>):</span><br><span class="line">        res_str += <span class="built_in">chr</span>(<span class="built_in">int</span>(bin_str[i:i + <span class="number">8</span>], <span class="number">2</span>))</span><br><span class="line">    <span class="keyword">return</span> res_str</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    solve_stego()</span><br></pre></td></tr></table></figure>
<p>ç»“æœä¸ºï¼š <img data-src="https://img-blog.csdnimg.cn/20210507002527114.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MjQ0NjA5NQ==,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" /></p>
<h2 id="ç»“è¯­">ç»“è¯­</h2>
<p>å¯ä»¥æš‚åœï¼Œä½†ä¸èƒ½æ”¾å¼ƒ å¸Œæœ›ç»§ç»­åšæŒ</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://luozj1020.github.io/uncategorized/2021/04/30/week5-6/BUUCTF%20%E6%AF%8F%E6%97%A5%E6%89%93%E5%8D%A1%202021-4-30">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Î£2333!">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Î£2333! ã® åšå®¢">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/uncategorized/2021/04/30/week5-6/BUUCTF%20%E6%AF%8F%E6%97%A5%E6%89%93%E5%8D%A1%202021-4-30" class="post-title-link" itemprop="url">BUUCTF æ¯æ—¥æ‰“å¡ 2021-4-30</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2021-04-30 00:00:00" itemprop="dateCreated datePublished" datetime="2021-04-30T00:00:00+08:00">2021-04-30</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2021-08-12 16:46:08" itemprop="dateModified" datetime="2021-08-12T16:46:08+08:00">2021-08-12</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="buuctf-æ¯æ—¥æ‰“å¡-2021-4-30">BUUCTF æ¯æ—¥æ‰“å¡ 2021-4-30</h2>
<h2 id="å¼•è¨€">å¼•è¨€</h2>
<p>å•Š äº”ä¸€å‡æœŸå¼€å§‹äº†</p>
<h2 id="åè›‹æ˜¯é›·å®¾">åè›‹æ˜¯é›·å®¾</h2>
<p>é¢˜ç›®æè¿°å¦‚ä¸‹ï¼š <img data-src="https://img-blog.csdnimg.cn/20210430230435523.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MjQ0NjA5NQ==,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" /> çœ‹åˆ°æ ¡éªŒç ï¼Œæƒ³èµ·ä¹‹å‰ä¸€ä¸ªå¥‡å¶æ ¡éªŒä½çš„é¢˜ ä½†æ˜¯å¥½åƒè¡Œä¸é€š åªèƒ½æ‰¾ <a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_44017838/article/details/104895787">wp</a> å¾—çŸ¥æ˜¯ <a target="_blank" rel="noopener" href="https://ctf-wiki.org/crypto/asymmetric/rsa/rsa_e_attack/#rsa-rabin">RSA è¡ç”Ÿç®—æ³•â€”â€”Rabin ç®—æ³•</a> <img data-src="https://img-blog.csdnimg.cn/20210430230903257.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MjQ0NjA5NQ==,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" /> wp ä¸­æ²¡æœ‰é‡‡ç”¨åŸå§‹çš„æ”»å‡»æ–¹æ³• è€Œæ˜¯é‡‡ç”¨ä¸‹é¢çš„æ–¹æ³• <img data-src="https://img-blog.csdnimg.cn/2021043023095216.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MjQ0NjA5NQ==,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" /> å¦‚æœæŠŠ wp ä¸­çš„ä»£ç æ”¾åˆ° python3 ä¸­è¿è¡Œä¼šæŠ¥é”™ï¼š TypeError: pow() 3rd argument not allowed unless all arguments are integers åº”è¯¥ä¸ºï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># p = q = 3 (mod 4)</span></span><br><span class="line">mp = <span class="built_in">pow</span>(c, (p + <span class="number">1</span>) // <span class="number">4</span>, p)</span><br><span class="line">mq = <span class="built_in">pow</span>(c, (q + <span class="number">1</span>) // <span class="number">4</span>, q)</span><br></pre></td></tr></table></figure>
<p>å¦ä¸€å¤„å€¼å¾—æ³¨æ„çš„åœ°æ–¹æ˜¯ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">inv_p = invert(p, q)</span><br><span class="line">inv_q = invert(q, p)</span><br></pre></td></tr></table></figure>
<p>æ²¡æœ‰é‡‡ç”¨æ‰©å±•æ¬§å‡ é‡Œå¾—æ±‚ <span class="math inline">\(y_{p},y_{q}\)</span> ï¼Œè€Œæ˜¯é‡‡ç”¨æ±‚é€†å…ƒçš„æ–¹æ³• åŸç†æ˜¯ï¼š ç”±äº <span class="math display">\[
y_{p} * p + y_{q} * q = 1
\]</span> æ‰€ä»¥ä¸¤è¾¹åˆ†åˆ«å¯¹ <span class="math inline">\(p, q\)</span> å–æ¨¡ å¯å¾— <span class="math display">\[
\begin{cases}
y_{p}*q \equiv 1\space (mod \space p)\\
y_{q}*p \equiv 1\space (mod \space q)
\end{cases}
\]</span> ç›´æ¥ç”¨ gmpy2 åº“ä¸­çš„ gcdext() æ–¹æ³•å®ç°æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•çš„ä»£ç å¦‚ä¸‹ï¼š <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">g, yp, yq = gmpy2.gcdext(p, q)</span><br></pre></td></tr></table></figure> ä¸‹ä¸€æ­¥ï¼š <img data-src="https://img-blog.csdnimg.cn/20210430231746752.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" /> æ ¹æ®é¢˜ç›®æè¿°ï¼šå¯†æ–‡æ˜¯162853095ï¼Œæ ¡éªŒç äºŒè¿›åˆ¶å€¼æ˜¯110001ï¼Œæ ¹æ®è¯´æ˜æ˜¯æ”¾åœ¨æ˜æ–‡åä¸€èµ·åŠ å¯†çš„ï¼Œæ˜æ–‡ä¸å¯†æ–‡é•¿åº¦ç›¸åŒã€‚ ä»å››ä¸ªæ˜æ–‡ä¸­æ‰¾åˆ°æ­£ç¡®çš„æ˜æ–‡ å®Œæ•´ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">n = <span class="number">523798549</span></span><br><span class="line">p = <span class="number">10663</span></span><br><span class="line">q = <span class="number">49123</span></span><br><span class="line">c = <span class="number">162853095</span></span><br><span class="line"><span class="comment"># p = q = 3 (mod 4)</span></span><br><span class="line">mp = <span class="built_in">pow</span>(c, (p + <span class="number">1</span>) // <span class="number">4</span>, p)</span><br><span class="line">mq = <span class="built_in">pow</span>(c, (q + <span class="number">1</span>) // <span class="number">4</span>, q)</span><br><span class="line"></span><br><span class="line">g, yp, yq = gmpy2.gcdext(p, q)</span><br><span class="line"></span><br><span class="line">a = (yp * p * mq + yq * q * mp) % n</span><br><span class="line">b = n - a</span><br><span class="line">c = (yp * p * mq - yq * q * mp) % n</span><br><span class="line">d = n - c</span><br><span class="line"></span><br><span class="line">check = <span class="string">&#x27;110001&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> [a, b, c, d]:</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">bin</span>(i)[<span class="number">2</span>:][-<span class="built_in">len</span>(check):] == check:</span><br><span class="line">        <span class="built_in">print</span>(i)</span><br><span class="line">        m = i</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">int</span>(<span class="built_in">bin</span>(m)[<span class="number">2</span>:][:-<span class="built_in">len</span>(check)], <span class="number">2</span>))</span><br></pre></td></tr></table></figure>
<p>n å¯ä»¥ç›´æ¥çˆ†ç ´ï¼Œè¿™é‡Œä¸å†èµ˜è¿° æœ€åå¾—åˆ°çš„ mï¼Œ<a target="_blank" rel="noopener" href="https://tool.chinaz.com/tools/md5.aspx">MD5 åŠ å¯†</a> ç»“æœå¦‚ä¸‹ï¼š <img data-src="https://img-blog.csdnimg.cn/20210430232002397.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MjQ0NjA5NQ==,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" /> å“ˆå¸Œå€¼å³ä¸º flag</p>
<h2 id="ç»“è¯­">ç»“è¯­</h2>
<p>ç´¯äº†ç´¯äº† è¿˜æ˜¯å¥½å¥½äº«å—å‡æœŸå§ å¸Œæœ›ç»§ç»­åšæŒ</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://luozj1020.github.io/uncategorized/2021/04/29/week5-6/BUUCTF%20%E6%AF%8F%E6%97%A5%E6%89%93%E5%8D%A1%202021-4-29">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Î£2333!">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Î£2333! ã® åšå®¢">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/uncategorized/2021/04/29/week5-6/BUUCTF%20%E6%AF%8F%E6%97%A5%E6%89%93%E5%8D%A1%202021-4-29" class="post-title-link" itemprop="url">BUUCTF æ¯æ—¥æ‰“å¡ 2021-4-29</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2021-04-29 00:00:00" itemprop="dateCreated datePublished" datetime="2021-04-29T00:00:00+08:00">2021-04-29</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2021-08-12 16:46:08" itemprop="dateModified" datetime="2021-08-12T16:46:08+08:00">2021-08-12</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="buuctf-æ¯æ—¥æ‰“å¡-2021-4-29">BUUCTF æ¯æ—¥æ‰“å¡ 2021-4-29</h2>
<h2 id="å¼•è¨€">å¼•è¨€</h2>
<p>è“å¸½æ¯å°±ä¸€é“ crypto åˆæ˜¯æ–æ³¢é‚£å¥‘æ•°åˆ—ï¼Œåˆæ˜¯ AES ç½‘ä¸ŠæŸ¥åˆ°ä»€ä¹ˆæ–æ³¢é‚£å¥‘æ•°åˆ—åŒæ··æ²ŒåŠ å¯† åæ­£å°±æ˜¯æ²¡åšå‡ºæ¥ã€‚ã€‚ã€‚ ç­‰ä»€ä¹ˆæ—¶å€™ wp å‡ºæ¥å†è¯´å§ã€‚ã€‚ã€‚</p>
<h2 id="boom">boom</h2>
<p>é™„ä»¶æ˜¯ä¸€ä¸ª .exe æ–‡ä»¶ ä¸ä¼šæ˜¯ä¸ª re é¢˜å§ã€‚ã€‚ã€‚ åœ¨å‘½ä»¤è¡Œæ‰“å¼€ï¼ˆå¦‚æœä¸åœ¨å‘½ä»¤è¡Œæ‰“å¼€ï¼Œæœ€åè¾“å‡ºä¼šç›´æ¥å…³é—­çª—å£ï¼‰ <img data-src="https://img-blog.csdnimg.cn/20210429185222439.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MjQ0NjA5NQ==,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" /> Do you like vanâ™‚ you see?ï¼ˆå¤§é›¾ï¼‰ ä¸‹ä¸€æ­¥ <img data-src="https://img-blog.csdnimg.cn/20210429185246243.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" /> æäº¤ md5 å¯ä»¥ç›´æ¥<a target="_blank" rel="noopener" href="https://www.cmd5.com/">æŸ¥è¯¢</a>å¾—åˆ° <img data-src="https://img-blog.csdnimg.cn/20210429184816708.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MjQ0NjA5NQ==,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" /> è¾“å…¥ç»“æœ <img data-src="https://img-blog.csdnimg.cn/20210429185334753.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" /> ä¸‹ä¸€æ­¥ <img data-src="https://img-blog.csdnimg.cn/20210429185357601.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" /> è§£ä¸‰å…ƒä¸€æ¬¡æ–¹ç¨‹ç»„ å½“ç„¶ä½ å¯ä»¥æ‰‹ç®— è¿™é‡Œæˆ‘ä»¬ç›´æ¥ç”¨ sagemath è®¡ç®—ï¼ˆèººï¼‰ ç»“æœå¦‚ä¸‹ï¼š <img data-src="https://img-blog.csdnimg.cn/20210429185524985.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MjQ0NjA5NQ==,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" /> æœ€åä¸€æ­¥ï¼š <img data-src="https://img-blog.csdnimg.cn/20210429185617123.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" /> è¿˜æ˜¯ç”¨ sagemath æ±‚è§£ <img data-src="https://img-blog.csdnimg.cn/20210429185656219.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MjQ0NjA5NQ==,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" /> è¾“å…¥å…¶ä¸­ä¸€ä¸ªè§£å³å¯ <img data-src="https://img-blog.csdnimg.cn/2021042918572871.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MjQ0NjA5NQ==,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" /> å½“ç„¶ä½ å¯ä»¥ re [doge] æŠŠå®ƒä¸¢å°½ IDA é‡Œé¢ï¼Œå¯ä»¥å¾—åˆ°ç¨‹åºçš„æ¡†æ¶ è¿™é‡Œç”¨çš„çš„è½¯ä»¶æ˜¯ IDA Freeware 7.0 å…ˆçœ‹è¾“å‡º flag çš„éƒ¨åˆ†ï¼š <img data-src="https://img-blog.csdnimg.cn/20210429190130563.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MjQ0NjA5NQ==,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" /> å‘ç° flag æ˜¯ç”±ä¸‰éƒ¨åˆ†ç»„æˆ ç¬¬ä¸€éƒ¨åˆ†ï¼š <img data-src="https://img-blog.csdnimg.cn/20210429185912455.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MjQ0NjA5NQ==,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" /> ç¬¬äºŒéƒ¨åˆ†ï¼š <img data-src="https://img-blog.csdnimg.cn/20210429190033880.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MjQ0NjA5NQ==,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" /> ç¬¬ä¸‰éƒ¨åˆ†ï¼š <img data-src="https://img-blog.csdnimg.cn/20210429190054324.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MjQ0NjA5NQ==,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" /> å®¹æ˜“çŸ¥é“ flag å³ä¸ºä¸Šé¢ä¸‰éƒ¨åˆ†ç­”æ¡ˆæ‹¼æ¥è€Œæˆ</p>
<h2 id="bse">B@se</h2>
<p>é™„ä»¶å†…å®¹å¦‚ä¸‹ï¼š <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">å¯†æ–‡ï¼šMyLkTaP3FaA7KOWjTmKkVjWjVzKjdeNvTnAjoH9iZOIvTeHbvD==</span><br><span class="line">JASGBWcQPRXEFLbCDIlmnHUVKTYZdMovwipatNOefghq56rs****kxyz012789+/</span><br><span class="line"></span><br><span class="line">oh holy shit, something is missing...</span><br></pre></td></tr></table></figure> ç¬¬ä¸€è¡Œæ˜¯å¯†æ–‡ ç¬¬äºŒè¡Œå®¹æ˜“çŒœåˆ°æ˜¯é‡æ–°æ’åˆ—çš„ Base64 ç¼–ç å¯¹ç…§è¡¨ åªæ˜¯å…¶ä¸­å‡ ä¸ªå­—ç¬¦ç¼ºå¤±äº† ç¼–å†™ä»£ç ï¼š <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">judge</span>(<span class="params">key, start, end</span>):</span></span><br><span class="line">    s = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(start, end+<span class="number">1</span>):</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> <span class="built_in">chr</span>(i) <span class="keyword">in</span> key:</span><br><span class="line">            s += <span class="built_in">chr</span>(i)</span><br><span class="line">    <span class="keyword">return</span> s</span><br><span class="line">unknown = judge(key, <span class="built_in">ord</span>(<span class="string">&#x27;A&#x27;</span>), <span class="built_in">ord</span>(<span class="string">&#x27;Z&#x27;</span>)) + judge(key, <span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>), <span class="built_in">ord</span>(<span class="string">&#x27;z&#x27;</span>)) + judge(key, <span class="built_in">ord</span>(<span class="string">&#x27;0&#x27;</span>), <span class="built_in">ord</span>(<span class="string">&#x27;9&#x27;</span>))</span><br><span class="line">unknown_list = <span class="built_in">list</span>(unknown)</span><br><span class="line"><span class="built_in">print</span>(unknown_list)</span><br></pre></td></tr></table></figure> å¯ä»¥å¾—å‡ºç¼ºå¤±çš„å­—ç¬¦ä¸º ['j', 'u', '3', '4'] å¯¹å…¶è¿›è¡Œæ’åˆ—ç»„åˆï¼Œæ›¿æ¢å¯¹ç…§è¡¨ä¸­ç¼ºå¤±çš„å­—ç¬¦ ç„¶åæŒ‰ç…§ Base64 çš„ç¼–ç è§„åˆ™ç¼–å†™ç¨‹åº ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line"></span><br><span class="line">c = <span class="string">&#x27;MyLkTaP3FaA7KOWjTmKkVjWjVzKjdeNvTnAjoH9iZOIvTeHbvD==&#x27;</span></span><br><span class="line">key = <span class="string">&#x27;JASGBWcQPRXEFLbCDIlmnHUVKTYZdMovwipatNOefghq56rs****kxyz012789+/&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decrypt</span>(<span class="params">c, key</span>):</span></span><br><span class="line">    b = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    s = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(c)):</span><br><span class="line">        <span class="keyword">if</span> c[i] == <span class="string">&#x27;=&#x27;</span>:</span><br><span class="line">            b += <span class="string">&#x27;0&#x27;</span>*<span class="number">6</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            b += <span class="built_in">bin</span>(<span class="built_in">list</span>(key).index(c[i]))[<span class="number">2</span>:].zfill(<span class="number">6</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(b), <span class="number">8</span>):</span><br><span class="line">        s += <span class="built_in">chr</span>(<span class="built_in">int</span>(b[i:i+<span class="number">8</span>], <span class="number">2</span>))</span><br><span class="line">    <span class="built_in">print</span>(s)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">judge</span>(<span class="params">key, start, end</span>):</span></span><br><span class="line">    s = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(start, end+<span class="number">1</span>):</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> <span class="built_in">chr</span>(i) <span class="keyword">in</span> key:</span><br><span class="line">            s += <span class="built_in">chr</span>(i)</span><br><span class="line">    <span class="keyword">return</span> s</span><br><span class="line">unknown = judge(key, <span class="built_in">ord</span>(<span class="string">&#x27;A&#x27;</span>), <span class="built_in">ord</span>(<span class="string">&#x27;Z&#x27;</span>)) + judge(key, <span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>), <span class="built_in">ord</span>(<span class="string">&#x27;z&#x27;</span>)) + judge(key, <span class="built_in">ord</span>(<span class="string">&#x27;0&#x27;</span>), <span class="built_in">ord</span>(<span class="string">&#x27;9&#x27;</span>))</span><br><span class="line">unknown_list = <span class="built_in">list</span>(unknown)</span><br><span class="line"><span class="built_in">print</span>(unknown_list)</span><br><span class="line">combination = <span class="built_in">list</span>(itertools.permutations(unknown_list,<span class="number">4</span>))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(combination)):</span><br><span class="line">    key_new = key.replace(<span class="string">&#x27;****&#x27;</span>, <span class="string">&#x27;&#x27;</span>.join(<span class="built_in">list</span>(combination[i])))</span><br><span class="line">    <span class="built_in">print</span>(key_new)</span><br><span class="line">    decrypt(c, key_new)</span><br></pre></td></tr></table></figure>
<p>è¾“å‡ºç»“æœä¸ºï¼š <img data-src="https://img-blog.csdnimg.cn/20210429205713681.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MjQ0NjA5NQ==,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" /> å¯ä»¥çœ‹åˆ°ä¼šæœ‰å¾ˆå¤šé‡å¤çš„å†…å®¹ åº”è¯¥æ˜¯ç”±äºæœ‰äº›å­—ç¬¦åœ¨ç¼–ç è¡¨ä¸­æ²¡æœ‰å¯¹åº”çš„å­—ç¬¦ï¼Œæˆ–è€…å¯¹åº”çš„å­—ç¬¦åœ¨ä¸åŒæ’åˆ—ç»„åˆçš„ç¼–ç è¡¨ä¸­çš„ä½ç½®ç›¸åŒ ç»“æœä¸ºï¼šwctf2120{base64_1s_v3ry_e@sy_and_fuN}</p>
<h2 id="ç»“è¯­">ç»“è¯­</h2>
<p>å¸Œæœ›ç»§ç»­åšæŒ</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://luozj1020.github.io/uncategorized/2021/04/28/week5-6/BUUCTF%20%E6%AF%8F%E6%97%A5%E6%89%93%E5%8D%A1%202021-4-28">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Î£2333!">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Î£2333! ã® åšå®¢">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/uncategorized/2021/04/28/week5-6/BUUCTF%20%E6%AF%8F%E6%97%A5%E6%89%93%E5%8D%A1%202021-4-28" class="post-title-link" itemprop="url">BUUCTF æ¯æ—¥æ‰“å¡ 2021-4-28</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2021-04-28 00:00:00" itemprop="dateCreated datePublished" datetime="2021-04-28T00:00:00+08:00">2021-04-28</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2021-08-12 16:46:08" itemprop="dateModified" datetime="2021-08-12T16:46:08+08:00">2021-08-12</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="buuctf-æ¯æ—¥æ‰“å¡-2021-4-28">BUUCTF æ¯æ—¥æ‰“å¡ 2021-4-28</h2>
<h2 id="å¼•è¨€">å¼•è¨€</h2>
<p>æ•°åˆ†è€ƒå®Œäº† æ˜å¤©è“å¸½æ¯</p>
<h2 id="å¯æ€œçš„rsa">å¯æ€œçš„RSA</h2>
<p>é™„ä»¶ç»™äº†å…¬é’¥ï¼š <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">-----BEGIN PUBLIC KEY-----</span><br><span class="line">MIIBJDANBgkqhkiG9w0BAQEFAAOCAREAMIIBDAKCAQMlsYv184kJfRcjeGa7Uc/<span class="number">4</span></span><br><span class="line">3pIkU3SevEA7CZXJfA44bUbBYcrf93xphg2uR5HCFM+Eh6qqnybpIKl3g0kGA4rv</span><br><span class="line">tcMIJ9/PP8npdpVE+U4Hzf4IcgOaOmJiEWZ4smH7LWudMlOekqFTs2dWKbqzlC59</span><br><span class="line">NeMPfu9avxxQ15fQzIjhvcz9GhLqb373XDcn298ueA80KK6Pek+3qJ8YSjZQMrFT</span><br><span class="line">+EJehFdQ6yt6vALcFc4CB1B6qVCGO7hICngCjdYpeZRNbGM/r6ED5Nsozof1oMbt</span><br><span class="line">Si8mZEJ/Vlx3gathkUVtlxx/+jlScjdM7AFV5fkRidt0LkwosDoPoRz/sDFz0qTM</span><br><span class="line">5q5TAgMBAAE=</span><br><span class="line">-----END PUBLIC KEY-----</span><br></pre></td></tr></table></figure> æå–å…¬é’¥ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;public.key&quot;</span>,<span class="string">&quot;r&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    key = RSA.import_key(f.read())</span><br><span class="line">    <span class="built_in">print</span>(key.n)</span><br><span class="line">    <span class="built_in">print</span>(key.e)</span><br></pre></td></tr></table></figure>
<p>å¾—åˆ° <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">e = <span class="number">65537</span></span><br><span class="line">n = <span class="number">79832181757332818552764610761349592984614744432279135328398999801627880283610900361281249973175805069916210179560506497075132524902086881120372213626641879468491936860976686933630869673826972619938321951599146744807653301076026577949579618331502776303983485566046485431039541708467141408260220098592761245010678592347501894176269580510459729633673468068467144199744563731826362102608811033400887813754780282628099443490170016087838606998017490456601315802448567772411623826281747245660954245413781519794295336197555688543537992197142258053220453757666537840276416475602759374950715283890232230741542737319569819793988431443</span></span><br></pre></td></tr></table></figure> ç„¶å<a target="_blank" rel="noopener" href="http://factordb.com/">çˆ†ç ´</a>å°±å¯ä»¥æ±‚å‡º p,q <img data-src="https://img-blog.csdnimg.cn/20210428222452204.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MjQ0NjA5NQ==,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" /> <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">p = <span class="number">3133337</span></span><br><span class="line">q = <span class="number">25478326064937419292200172136399497719081842914528228316455906211693118321971399936004729134841162974144246271486439695786036588117424611881955950996219646807378822278285638261582099108339438949573034101215141156156408742843820048066830863814362379885720395082318462850002901605689761876319151147352730090957556940842144299887394678743607766937828094478336401159449035878306853716216548374273462386508307367713112073004011383418967894930554067582453248981022011922883374442736848045920676341361871231787163441467533076890081721882179369168787287724769642665399992556052144845878600126283968890273067575342061776244939</span></span><br></pre></td></tr></table></figure></p>
<p>é™„ä»¶å¯†æ–‡å¦‚ä¸‹ï¼š <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GVd1d3viIXFfcHapEYuo5fAvIiUS83adrtMW/MgPwxVBSl46joFCQ1plcnlDGfL19K/3PvChV6n5QGohzfVyz2Z5GdTlaknxvHDUGf5HCukokyPwK/1EYU7NzrhGE7J5jPdi0Aj7xi/Odxy0hGMgpaBLd/nL3N8O6i9pc4Gg3O8soOlciBG/<span class="number">6</span>/xdfN3SzSStMYIN8nfZZMSq3xDDvz4YB7TcTBh4ik4wYhuC77gmT+HWOv5gLTNQ3EkZs5N3EAopy11zHNYU80yv1jtFGcluNPyXYttU5qU33jcp0Wuznac+t+AZHeSQy5vk8DyWorSGMiS+J4KNqSVlDs12EqXEqqJ0uA==</span><br></pre></td></tr></table></figure> å®¹æ˜“å‘ç°ç»è¿‡äº† base64 åŠ å¯† å°è¯•è§£å¯†ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="comment"># p,q,n,e</span></span><br><span class="line">c = bytes_to_long(base64.b64decode(<span class="string">b&#x27;GVd1d3viIXFfcHapEYuo5fAvIiUS83adrtMW/MgPwxVBSl46joFCQ1plcnlDGfL19K/3PvChV6n5QGohzfVyz2Z5GdTlaknxvHDUGf5HCukokyPwK/1EYU7NzrhGE7J5jPdi0Aj7xi/Odxy0hGMgpaBLd/nL3N8O6i9pc4Gg3O8soOlciBG/6/xdfN3SzSStMYIN8nfZZMSq3xDDvz4YB7TcTBh4ik4wYhuC77gmT+HWOv5gLTNQ3EkZs5N3EAopy11zHNYU80yv1jtFGcluNPyXYttU5qU33jcp0Wuznac+t+AZHeSQy5vk8DyWorSGMiS+J4KNqSVlDs12EqXEqqJ0uA==&#x27;</span>))</span><br><span class="line"></span><br><span class="line">phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d = inverse(e, phi)</span><br><span class="line">m = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure>
<p>å‘ç°æ˜¯ä¸€å †ä¹±ç  <img data-src="https://img-blog.csdnimg.cn/20210428222655128.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" /> å—¯ï¼Ÿ æœ€åæ±‚åŠ© <a target="_blank" rel="noopener" href="https://www.cnblogs.com/vict0r/p/13764404.html">wp</a> ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> PKCS1_OAEP</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="comment"># p,q,n,e</span></span><br><span class="line">c = base64.b64decode(<span class="string">b&#x27;GVd1d3viIXFfcHapEYuo5fAvIiUS83adrtMW/MgPwxVBSl46joFCQ1plcnlDGfL19K/3PvChV6n5QGohzfVyz2Z5GdTlaknxvHDUGf5HCukokyPwK/1EYU7NzrhGE7J5jPdi0Aj7xi/Odxy0hGMgpaBLd/nL3N8O6i9pc4Gg3O8soOlciBG/6/xdfN3SzSStMYIN8nfZZMSq3xDDvz4YB7TcTBh4ik4wYhuC77gmT+HWOv5gLTNQ3EkZs5N3EAopy11zHNYU80yv1jtFGcluNPyXYttU5qU33jcp0Wuznac+t+AZHeSQy5vk8DyWorSGMiS+J4KNqSVlDs12EqXEqqJ0uA==&#x27;</span>)</span><br><span class="line"></span><br><span class="line">phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d = inverse(e, phi)</span><br><span class="line">key_info = RSA.construct((n, e, d, p, q))</span><br><span class="line">key = RSA.importKey(key_info.exportKey())</span><br><span class="line">key = PKCS1_OAEP.new(key)</span><br><span class="line"><span class="built_in">print</span>(key.decrypt(c))</span><br></pre></td></tr></table></figure>
<p>ç»“æœä¸ºï¼šafctf{R54_|5_$0_B0rin9} å•Šè¿™ å¤šè¥¿å¾—ï¼Ÿ æˆ‘ä»¬çŸ¥é“ï¼Œ Crypto.Util åŒ…ä¸­ long_to_bytes æ–¹æ³•æ˜¯å°†å­—ç¬¦ä¸²è½¬åŒ–æˆäºŒè¿›åˆ¶ç„¶åè½¬åŒ–æˆåè¿›åˆ¶ ç¤ºä¾‹å¦‚ä¸‹ï¼š <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">print</span>(bytes_to_long(<span class="string">b&#x27;AB&#x27;</span>))</span><br><span class="line"><span class="number">16706</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">print</span>(<span class="built_in">bin</span>(<span class="built_in">ord</span>(<span class="string">&#x27;A&#x27;</span>)))</span><br><span class="line"><span class="number">0b1000001</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">print</span>(<span class="built_in">bin</span>(<span class="built_in">ord</span>(<span class="string">&#x27;B&#x27;</span>)))</span><br><span class="line"><span class="number">0b1000010</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">print</span>(<span class="built_in">hex</span>(<span class="built_in">ord</span>(<span class="string">&#x27;A&#x27;</span>)))</span><br><span class="line"><span class="number">0x41</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">print</span>(<span class="built_in">hex</span>(<span class="built_in">ord</span>(<span class="string">&#x27;B&#x27;</span>)))</span><br><span class="line"><span class="number">0x42</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">print</span>(<span class="built_in">int</span>(<span class="string">&#x27;4142&#x27;</span>,<span class="number">16</span>))</span><br><span class="line"><span class="number">16706</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">print</span>(<span class="built_in">int</span>(<span class="string">&#x27;100000101000010&#x27;</span>,<span class="number">2</span>))</span><br><span class="line"><span class="number">16706</span></span><br></pre></td></tr></table></figure> ç„¶åæˆ‘åˆæ‰¾äº† Crypto.Cipher åŒ…ä¸­çš„ decrypt æ–¹æ³•<a target="_blank" rel="noopener" href="https://github.com/Legrandin/pycryptodome/blob/master/lib/Crypto/Cipher/PKCS1_OAEP.py">æºç </a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decrypt</span>(<span class="params">self, ciphertext</span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;Decrypt a message with PKCS#1 OAEP.</span></span><br><span class="line"><span class="string">    :param ciphertext: The encrypted message.</span></span><br><span class="line"><span class="string">    :type ciphertext: bytes/bytearray/memoryview</span></span><br><span class="line"><span class="string">    :returns: The original message (plaintext).</span></span><br><span class="line"><span class="string">    :rtype: bytes</span></span><br><span class="line"><span class="string">    :raises ValueError:</span></span><br><span class="line"><span class="string">        if the ciphertext has the wrong length, or if decryption</span></span><br><span class="line"><span class="string">        fails the integrity check (in which case, the decryption</span></span><br><span class="line"><span class="string">        key is probably wrong).</span></span><br><span class="line"><span class="string">    :raises TypeError:</span></span><br><span class="line"><span class="string">        if the RSA key has no private half (i.e. you are trying</span></span><br><span class="line"><span class="string">        to decrypt using a public key).</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># See 7.1.2 in RFC3447</span></span><br><span class="line">    modBits = Crypto.Util.number.size(self._key.n)</span><br><span class="line">    k = ceil_div(modBits,<span class="number">8</span>) <span class="comment"># Convert from bits to bytes</span></span><br><span class="line">    hLen = self._hashObj.digest_size</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Step 1b and 1c</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(ciphertext) != k <span class="keyword">or</span> k&lt;hLen+<span class="number">2</span>:</span><br><span class="line">        <span class="keyword">raise</span> ValueError(<span class="string">&quot;Ciphertext with incorrect length.&quot;</span>)</span><br><span class="line">    <span class="comment"># Step 2a (O2SIP)</span></span><br><span class="line">    ct_int = bytes_to_long(ciphertext)</span><br><span class="line">    <span class="comment"># Step 2b (RSADP)</span></span><br><span class="line">    m_int = self._key._decrypt(ct_int)</span><br><span class="line">    <span class="comment"># Complete step 2c (I2OSP)</span></span><br><span class="line">    em = long_to_bytes(m_int, k)</span><br><span class="line">    <span class="comment"># Step 3a</span></span><br><span class="line">    lHash = self._hashObj.new(self._label).digest()</span><br><span class="line">    <span class="comment"># Step 3b</span></span><br><span class="line">    y = em[<span class="number">0</span>]</span><br><span class="line">    <span class="comment"># y must be 0, but we MUST NOT check it here in order not to</span></span><br><span class="line">    <span class="comment"># allow attacks like Manger&#x27;s (http://dl.acm.org/citation.cfm?id=704143)</span></span><br><span class="line">    maskedSeed = em[<span class="number">1</span>:hLen+<span class="number">1</span>]</span><br><span class="line">    maskedDB = em[hLen+<span class="number">1</span>:]</span><br><span class="line">    <span class="comment"># Step 3c</span></span><br><span class="line">    seedMask = self._mgf(maskedDB, hLen)</span><br><span class="line">    <span class="comment"># Step 3d</span></span><br><span class="line">    seed = strxor(maskedSeed, seedMask)</span><br><span class="line">    <span class="comment"># Step 3e</span></span><br><span class="line">    dbMask = self._mgf(seed, k-hLen-<span class="number">1</span>)</span><br><span class="line">    <span class="comment"># Step 3f</span></span><br><span class="line">    db = strxor(maskedDB, dbMask)</span><br><span class="line">    <span class="comment"># Step 3g</span></span><br><span class="line">    one_pos = hLen + db[hLen:].find(<span class="string">b&#x27;\x01&#x27;</span>)</span><br><span class="line">    lHash1 = db[:hLen]</span><br><span class="line">    invalid = bord(y) | <span class="built_in">int</span>(one_pos &lt; hLen)</span><br><span class="line">    hash_compare = strxor(lHash1, lHash)</span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> hash_compare:</span><br><span class="line">        invalid |= bord(x)</span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> db[hLen:one_pos]:</span><br><span class="line">        invalid |= bord(x)</span><br><span class="line">    <span class="keyword">if</span> invalid != <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">raise</span> ValueError(<span class="string">&quot;Incorrect decryption.&quot;</span>)</span><br><span class="line">    <span class="comment"># Step 4</span></span><br><span class="line">    <span class="keyword">return</span> db[one_pos + <span class="number">1</span>:]</span><br></pre></td></tr></table></figure>
<p>å…¶ä¸­ä¹Ÿæœ‰ long_to_bytes å’Œ bytes_to_long æ–¹æ³•ï¼ŒåŸç†ç±»ä¼¼ï¼ˆå¤§æ¦‚ï¼‰ å› ä¸ºä¸¾ä¾‹æ¯”è¾ƒéº»çƒ¦ï¼Œæ‰€ä»¥å°±æ²¡æœ‰å°è¯• æµè§ˆäº†ä¸€ä¸‹æºç ï¼ˆå› ä¸ºä¸æ€ä¹ˆçœ‹å¾—æ‡‚ï¼‰ï¼Œå‘ç°é‡Œé¢æœ‰ hash, xor ä¹‹ç±»çš„å­—çœ¼ è€Œä¸”çœ‹æ³¨é‡Šå†…å®¹ï¼ˆä¹Ÿå¯è§äº<a target="_blank" rel="noopener" href="https://pycryptodome.readthedocs.io/en/latest/src/cipher/oaep.html">å®˜æ–¹æ–‡æ¡£</a>ï¼‰ å‘ç°å®ƒå¯¹å¯†æ–‡é•¿åº¦ä¹Ÿåšäº†è¦æ±‚ï¼Œå¦‚æœå¯†æ–‡é•¿åº¦é”™è¯¯ä¼šæŠ¥é”™ ValueError å°±å¾ˆè¿·ã€‚ã€‚ã€‚</p>
<p>é‚£ä¹ˆå¦‚æœç¢°åˆ°äº†è¯¥æ€ä¹ˆåŠï¼Ÿ é‚£å°±å…ˆå°è¯•ç¬¬ä¸€ç§ä»£ç ï¼Œå†å°è¯•ç¬¬äºŒç§ä»£ç å’¯[æ‰¶é¢]</p>
<h2 id="single">Single</h2>
<p>åŠ å¯†ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="built_in">freopen</span>(<span class="string">&quot;Plain.txt&quot;</span>,<span class="string">&quot;r&quot;</span>,stdin);</span><br><span class="line">	<span class="built_in">freopen</span>(<span class="string">&quot;Cipher.txt&quot;</span>,<span class="string">&quot;w&quot;</span>,stdout);</span><br><span class="line">	map&lt;<span class="keyword">char</span>, <span class="keyword">char</span>&gt; f;</span><br><span class="line">	<span class="keyword">int</span> arr[<span class="number">26</span>];</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;<span class="number">26</span>;++i)&#123;</span><br><span class="line">		arr[i]=i;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">random_shuffle</span>(arr,arr+<span class="number">26</span>);</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;<span class="number">26</span>;++i)&#123;</span><br><span class="line">		f[<span class="string">&#x27;a&#x27;</span>+i]=<span class="string">&#x27;a&#x27;</span>+arr[i];</span><br><span class="line">		f[<span class="string">&#x27;A&#x27;</span>+i]=<span class="string">&#x27;A&#x27;</span>+arr[i];</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">char</span> ch;</span><br><span class="line">	<span class="keyword">while</span>((ch=<span class="built_in">getchar</span>())!=EOF)&#123;</span><br><span class="line">		<span class="keyword">if</span>(f.<span class="built_in">count</span>(ch))&#123;</span><br><span class="line">			<span class="built_in">putchar</span>(f[ch]);</span><br><span class="line">		&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">			<span class="built_in">putchar</span>(ch);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™å­¦æœŸåˆšå­¦ C è¯­è¨€ å¤§è‡´çœ‹äº†ä¸€ä¸‹ å¤§æ¦‚å°±æ˜¯ç»™æ˜æ–‡éšæœºç§»ä½äº†ä¸€ä¸‹ å¯†æ–‡å¦‚ä¸‹ï¼š <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">Jmqrida rva <span class="title">Lfmz</span> <span class="params">(JRL)</span> eu m uqajemf seny xl enlxdomrexn uajiderc jxoqarerexnu. Rvada mda rvdaa jxooxn rcqau xl JRLu: Paxqmdyc, Mrrmjs-Yalanja mny oekay.</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">Paxqmdyc-urcfa JRLu vmu m jxiqfa xl giaurexnu (rmusu) en dmnza xl jmrazxdeau. Lxd akmoqfa, Wab, Lxdanuej, Jdcqrx, Benmdc xd uxoarvenz afua. Ramo jmn zmen uxoa qxenru lxd atadc uxftay rmus. Oxda qxenru lxd oxda jxoqfejmray rmusu iuimffc. Rva nakr rmus en jvmen jmn ba xqanay xnfc mlrad uxoa ramo uxfta qdatexiu rmus. Rvan rva zmoa reoa eu xtad uio xl qxenru uvxwu cxi m JRL wenad. Lmoxiu akmoqfa xl uijv JRL eu Yaljxn JRL gimfu.</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">Waff, mrrmjs-yalanja eu mnxrvad enradaurenz seny xl jxoqarerexnu. Vada atadc ramo vmu xwn narwxds(xd xnfc xna vxur) werv tifnmdmbfa uadtejau. Cxid ramo vmu reoa lxd qmrjvenz cxid uadtejau mny yatafxqenz akqfxeru iuimffc. Ux, rvan xdzmnehadu jxnnajru qmdrejeqmnru xl jxoqarerexn mny rva wmdzmoa urmdru! Cxi uvxify qdxrajr xwn uadtejau lxd yalanja qxenru mny vmjs xqqxnanru lxd mrrmjs qxenru. Veurxdejmffc rveu eu m ledur rcqa xl JRLu, atadcbxyc snxwu mbxir YAL JXN JRL - uxoarvenz fesa m Wxdfy Jiq xl mff xrvad jxoqarerexnu.</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">Oekay jxoqarerexnu omc tmdc qxuuebfa lxdomru. Er omc ba uxoarvenz fesa wmdzmoa werv uqajemf reoa lxd rmus-bmuay afaoanru (a.z. IJUB eJRL).</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">JRL zmoau xlran rxijv xn omnc xrvad muqajru xl enlxdomrexn uajiderc: jdcqrxzdmqvc, urazx, benmdc mnmfcueu, datadua anzanaadenz, oxbefa uajiderc mny xrvadu. Zxxy ramou zanadmffc vmta urdxnz useffu mny akqadeanja en mff rvaua euuiau.</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">Iuimffc, lfmz eu uxoa urdenz xl dmnyxo ymrm xd rakr en uxoa lxdomr. Akmoqfa mljrl&#123;</span>Xv_I_lxiny_er_neja_rDc&#125;</span><br></pre></td></tr></table></figure> å°è¯•<a target="_blank" rel="noopener" href="https://quipqiup.com/">çˆ†ç ´</a> <img data-src="https://img-blog.csdnimg.cn/20210428225044309.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MjQ0NjA5NQ==,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" /> å•Šè¿™ å®Œäº‹äº†</p>
<h2 id="ç»“è¯­">ç»“è¯­</h2>
<p>è¿™å‡ å¤©çš„åšå®¢å±å®æ°´ ä¸»è¦æ˜¯æ•°åˆ†è€ƒè¯•çš„åŸå›  ï¼ˆä½†æ˜¯å·®ä¸å¤šå‡‰äº†ï¼Œæ±‚æ±‚ç»™æˆ‘åŠæ ¼å§ï¼‰ å¸Œæœ›ç»§ç»­åšæŒ</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/3/"><i class="fa fa-angle-left" aria-label="ä¸Šä¸€é¡µ"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/3/">3</a><span class="page-number current">4</span><a class="page-number" href="/page/5/">5</a><span class="space">&hellip;</span><a class="page-number" href="/page/8/">8</a><a class="extend next" rel="next" href="/page/5/"><i class="fa fa-angle-right" aria-label="ä¸‹ä¸€é¡µ"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          æ–‡ç« ç›®å½•
        </li>
        <li class="sidebar-nav-overview">
          ç«™ç‚¹æ¦‚è§ˆ
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Î£2333!</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">71</span>
          <span class="site-state-item-name">æ—¥å¿—</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">1</span>
        <span class="site-state-item-name">æ ‡ç­¾</span>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Î£2333!</span>
</div>
  <div class="powered-by">ç”± <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://pisces.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a> å¼ºåŠ›é©±åŠ¨
  </div>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="æ€»è®¿å®¢é‡">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="æ€»è®¿é—®é‡">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  
  <script color='255,250,250' opacity='0.7' zIndex='-1' count='80' src="/lib/canvas-nest/canvas-nest.min.js"></script>
  <script src="/lib/anime.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/lozad@1/dist/lozad.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  
      

<script>
  if (typeof MathJax === 'undefined') {
    window.MathJax = {
      loader: {
        source: {
          '[tex]/amsCd': '[tex]/amscd',
          '[tex]/AMScd': '[tex]/amscd'
        }
      },
      tex: {
        inlineMath: {'[+]': [['$', '$']]},
        tags: 'ams'
      },
      options: {
        renderActions: {
          findScript: [10, doc => {
            document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
              const display = !!node.type.match(/; *mode=display/);
              const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
              const text = document.createTextNode('');
              node.parentNode.replaceChild(text, node);
              math.start = {node: text, delim: '', n: 0};
              math.end = {node: text, delim: '', n: 0};
              doc.math.push(math);
            });
          }, '', false],
          insertedScript: [200, () => {
            document.querySelectorAll('mjx-container').forEach(node => {
              let target = node.parentNode;
              if (target.nodeName.toLowerCase() === 'li') {
                target.parentNode.classList.add('has-jax');
              }
            });
          }, '', false]
        }
      }
    };
    (function () {
      var script = document.createElement('script');
      script.src = '//cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js';
      script.defer = true;
      document.head.appendChild(script);
    })();
  } else {
    MathJax.startup.document.state(0);
    MathJax.texReset();
    MathJax.typeset();
  }
</script>

    

  


  

  <script async src="/js/cursor/fireworks.js"></script>




  <script src="/js/wobblewindow.js"></script>
  <script>
    //åªåœ¨æ¡Œé¢ç‰ˆç½‘é¡µå¯ç”¨ç‰¹æ•ˆ
    if( window.innerWidth > 768  ){
      $(document).ready(function () {
        
          $('#header').wobbleWindow({
            radius: 50,
            movementTop: false,
            movementLeft: false,
            movementRight: false,
            debug: false,
          });
        

        
          $('#sidebar').wobbleWindow({
            radius: 50,
            movementLeft: false,
            movementTop: false,
            movementBottom: false,
            position: 'fixed',
            debug: false,
          });
        

        
          $('#footer').wobbleWindow({
            radius: 50,
            movementBottom: false,
            movementLeft: false,
            movementRight: false,
            offsetX: ,
            position: 'absolute',
            debug: false,
          });
        
      });
    }
  </script>




  <script src="/js/activate-power-mode.min.js"></script>
  <script>
    POWERMODE.colorful = true;
    POWERMODE.shake = false;
    document.body.addEventListener('input', POWERMODE);
  </script>

</body>
</html>
<script src="https://cdn.jsdelivr.net/npm/jquery/dist/jquery.min.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome/css/font-awesome.min.css"/>
<script src="/live2d-widget/autoload.js"></script>

<!-- å¼•å…¥jQuery -->
<script type="text/javascript" src="//libs.baidu.com/jquery/1.8.3/jquery.min.js"></script>


<!-- é¡µé¢ç‚¹å‡»å°çº¢å¿ƒ -->
<script type="text/javascript" src="/js/clicklove.js"></script>

<!-- é›ªèŠ±ç‰¹æ•ˆ2 -->
<script type="text/javascript" src="/js/snow2.js"></script>
