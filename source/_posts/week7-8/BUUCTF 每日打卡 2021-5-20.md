---
title: BUUCTF 每日打卡 2021-5-20
date: 2021-05-20
tags: Crypto
mathjax: true
---

# BUUCTF 每日打卡 2021-5-20

## 引言

无



## EasyProgram

题目给了一堆加密伪代码：
get buf unsign s[256]
get buf t[256]
we have key:whoami
we have flag:????????????????????????????????

for i:0 to 256
    set s[i]:i

for i:0 to 256
    set t[i]:key[(i)mod(key.lenth)]

for i:0 to 256
    set j:(j+s[i]+t[i])mod(256)
        swap:s[i],s[j]

for m:0 to 38
    set i:(i + 1)mod(256)
    set j:(j + S[i])mod(256)
    swap:s[i],s[j]
    set x:(s[i] + (s[j]mod(256))mod(256))
    set flag[m]:flag[m]^s[x]

fprint flagx to file
可以发现，程序的前三个 for 循环都没有涉及到 flag，知识构造了两个数组 s, t，并且进行了一系列操作
在最后一个 for 循环中将 flag 与数组 s 做异或运算得到密文
所以只要按代码所述构造 s，然后与密文做异或运算即可得出密文
代码如下：

```python
with open("file.txt", 'rb') as f:
    c = f.read().hex()

flagx = [int(str(c)[i:i+2], 16) for i in range(0, len(c), 2)]
print(flagx)

s = []
t = []
key = 'whoami'
j = 0
for i in range(0, 256):
    s.append(i)

for i in range(0, 256):
    t.append(key[i % len(key)])

for i in range(0,256):
     j = (j+int(s[i]) + int(ord(t[i]))) % 256
     s[i], s[j] = s[j], s[i]

i = 0; j = 0; x = 0
for m in range(0, 38):
    i = (i + 1) % 256
    j = (j + s[i]) % 256
    s[i], s[j] = s[j], s[i]
    x = (s[i] + (s[j] % 256)) % 256
    flagx[m] = flagx[m] ^ s[x]

print(''.join(chr(flagx[i]) for i in range(0, 38)))
```
结果为：flag{f238yu28323uf28u2yef2ud8uf289euf}
参考代码：[https://www.codenong.com/cs106478950/](https://www.codenong.com/cs106478950/)



## Classical Cipher

附件内容是一个 key.txt 和一个包含了一张图片的加密压缩包
key.txt 内容为：
解密后的flag请用flag{}包裹
压缩包密码：gsv_pvb_rh_zgyzhs
对应明文：   \*\*\*\_key_\*\*\_\*\*\*\*\*\*

看到题目，猜想是凯撒密码
![在这里插入图片描述](https://img-blog.csdnimg.cn/20210520233321182.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MjQ0NjA5NQ==,size_16,color_FFFFFF,t_70)
但是不对
然后尝试用词频分析爆破：
![在这里插入图片描述](https://img-blog.csdnimg.cn/20210520233402725.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MjQ0NjA5NQ==,size_16,color_FFFFFF,t_70)
![在这里插入图片描述](https://img-blog.csdnimg.cn/20210520233416278.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MjQ0NjA5NQ==,size_16,color_FFFFFF,t_70)
试了几个，不行
只能用传统艺能：找 [wp](https://www.anquanke.com/post/id/217151)
原来是 [Atbash Cipher](https://ctf-wiki.org/crypto/classical/monoalphabetic/#atbash-cipher)（没碰到过）
解压加密压缩包，得到图片：
![在这里插入图片描述](https://img-blog.csdnimg.cn/20210520233730791.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MjQ0NjA5NQ==,size_16,color_FFFFFF,t_70#pic_center)
容易发现其中一种密码是变种的猪圈密码：
![在这里插入图片描述](https://img-blog.csdnimg.cn/20210520233901761.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MjQ0NjA5NQ==,size_16,color_FFFFFF,t_70)
另一种是啥？
原来是埃及象形文字（啊这）
![在这里插入图片描述](https://img-blog.csdnimg.cn/20210520234033839.png)
得到结果：
![在这里插入图片描述](https://img-blog.csdnimg.cn/20210520234049138.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MjQ0NjA5NQ==,size_16,color_FFFFFF,t_70#pic_center)
flag 均为小写，即为结果



## 结语

希望继续坚持